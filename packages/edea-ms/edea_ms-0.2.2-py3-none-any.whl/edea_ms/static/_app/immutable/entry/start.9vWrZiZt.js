import{o as Se,t as Ee}from"../chunks/scheduler.E6X4giYD.js";import{S as nt,a as at,b as rt,H as K,N as J,r as te,o as xe,P as Ae,f as We,g as Re,c as ue,i as ke,s as $e,d as V,e as F,h as Be,j as ft}from"../chunks/singletons.YLCiVgCN.js";import{p as ut,s as dt,u as pt}from"../chunks/stringify.ZBF_Z-nX.js";import{H as he,S as je,R as Ye}from"../chunks/control.bE1Jt2IV.js";new URL("sveltekit-internal://");function ht(a,o){return a==="/"||o==="ignore"?a:o==="never"?a.endsWith("/")?a.slice(0,-1):a:o==="always"&&!a.endsWith("/")?a+"/":a}function _t(a){return a.split("%25").map(decodeURI).join("%25")}function gt(a){for(const o in a)a[o]=decodeURIComponent(a[o]);return a}function Pe({href:a}){return a.split("#")[0]}const mt=["href","pathname","search","toString","toJSON"];function vt(a,o,f){const s=new URL(a);Object.defineProperty(s,"searchParams",{value:new Proxy(s.searchParams,{get(l,m){if(m==="get"||m==="getAll"||m==="has")return g=>(f(g),l[m](g));o();const w=Reflect.get(l,m);return typeof w=="function"?w.bind(l):w}}),enumerable:!0,configurable:!0});for(const l of mt)Object.defineProperty(s,l,{get(){return o(),a[l]},enumerable:!0,configurable:!0});return yt(s),s}function yt(a){Object.defineProperty(a,"hash",{get(){throw new Error("Cannot access event.url.hash. Consider using `$page.url.hash` inside a component instead")}})}const wt="/__data.json",bt=".html__data.json";function St(a){return a.endsWith(".html")?a.replace(/\.html$/,bt):a.replace(/\/$/,"")+wt}function Et(...a){let o=5381;for(const f of a)if(typeof f=="string"){let s=f.length;for(;s;)o=o*33^f.charCodeAt(--s)}else if(ArrayBuffer.isView(f)){const s=new Uint8Array(f.buffer,f.byteOffset,f.byteLength);let l=s.length;for(;l;)o=o*33^s[--l]}else throw new TypeError("value must be a string or TypedArray");return(o>>>0).toString(36)}const ot=window.fetch;window.fetch=(a,o)=>((a instanceof Request?a.method:o?.method||"GET")!=="GET"&&ae.delete(Te(a)),ot(a,o));const ae=new Map;function xt(a){const o=atob(a),f=new Uint8Array(o.length);for(let s=0;s<o.length;s++)f[s]=o.charCodeAt(s);return f.buffer}function At(a,o){const f=Te(a,o),s=document.querySelector(f);if(s?.textContent){let{body:l,...m}=JSON.parse(s.textContent);const w=s.getAttribute("data-ttl");return w&&ae.set(f,{body:l,init:m,ttl:1e3*Number(w)}),s.getAttribute("data-b64")!==null&&(l=xt(l)),Promise.resolve(new Response(l,m))}return window.fetch(a,o)}function Rt(a,o,f){if(ae.size>0){const s=Te(a,f),l=ae.get(s);if(l){if(performance.now()<l.ttl&&["default","force-cache","only-if-cached",void 0].includes(f?.cache))return new Response(l.body,l.init);ae.delete(s)}}return window.fetch(o,f)}function Te(a,o){let s=`script[data-sveltekit-fetched][data-url=${JSON.stringify(a instanceof Request?a.url:a)}]`;if(o?.headers||o?.body){const l=[];o.headers&&l.push([...new Headers(o.headers)].join(",")),o.body&&(typeof o.body=="string"||ArrayBuffer.isView(o.body))&&l.push(o.body),s+=`[data-hash="${Et(...l)}"]`}return s}const kt=/^(\[)?(\.\.\.)?(\w+)(?:=(\w+))?(\])?$/;function Pt(a){const o=[];return{pattern:a==="/"?/^\/$/:new RegExp(`^${Ut(a).map(s=>{const l=/^\[\.\.\.(\w+)(?:=(\w+))?\]$/.exec(s);if(l)return o.push({name:l[1],matcher:l[2],optional:!1,rest:!0,chained:!0}),"(?:/(.*))?";const m=/^\[\[(\w+)(?:=(\w+))?\]\]$/.exec(s);if(m)return o.push({name:m[1],matcher:m[2],optional:!0,rest:!1,chained:!0}),"(?:/([^/]+))?";if(!s)return;const w=s.split(/\[(.+?)\](?!\])/);return"/"+w.map((b,v)=>{if(v%2){if(b.startsWith("x+"))return Le(String.fromCharCode(parseInt(b.slice(2),16)));if(b.startsWith("u+"))return Le(String.fromCharCode(...b.slice(2).split("-").map(D=>parseInt(D,16))));const p=kt.exec(b);if(!p)throw new Error(`Invalid param: ${b}. Params and matcher names can only have underscores and alphanumeric characters.`);const[,$,O,L,I]=p;return o.push({name:L,matcher:I,optional:!!$,rest:!!O,chained:O?v===1&&w[0]==="":!1}),O?"(.*?)":$?"([^/]*)?":"([^/]+?)"}return Le(b)}).join("")}).join("")}/?$`),params:o}}function Lt(a){return!/^\([^)]+\)$/.test(a)}function Ut(a){return a.slice(1).split("/").filter(Lt)}function It(a,o,f){const s={},l=a.slice(1),m=l.filter(g=>g!==void 0);let w=0;for(let g=0;g<o.length;g+=1){const b=o[g];let v=l[g-w];if(b.chained&&b.rest&&w&&(v=l.slice(g-w,g+1).filter(p=>p).join("/"),w=0),v===void 0){b.rest&&(s[b.name]="");continue}if(!b.matcher||f[b.matcher](v)){s[b.name]=v;const p=o[g+1],$=l[g+1];p&&!p.rest&&p.optional&&$&&b.chained&&(w=0),!p&&!$&&Object.keys(s).length===m.length&&(w=0);continue}if(b.optional&&b.chained){w++;continue}return}if(!w)return s}function Le(a){return a.normalize().replace(/[[\]]/g,"\\$&").replace(/%/g,"%25").replace(/\//g,"%2[Ff]").replace(/\?/g,"%3[Ff]").replace(/#/g,"%23").replace(/[.*+?^${}()|\\]/g,"\\$&")}function Ot({nodes:a,server_loads:o,dictionary:f,matchers:s}){const l=new Set(o);return Object.entries(f).map(([g,[b,v,p]])=>{const{pattern:$,params:O}=Pt(g),L={id:g,exec:I=>{const D=$.exec(I);if(D)return It(D,O,s)},errors:[1,...p||[]].map(I=>a[I]),layouts:[0,...v||[]].map(w),leaf:m(b)};return L.errors.length=L.layouts.length=Math.max(L.errors.length,L.layouts.length),L});function m(g){const b=g<0;return b&&(g=~g),[b,a[g]]}function w(g){return g===void 0?g:[l.has(g),a[g]]}}function Ce(a,o=JSON.parse){try{return o(sessionStorage[a])}catch{}}function Ue(a,o,f=JSON.stringify){const s=f(o);try{sessionStorage[a]=s}catch{}}const st=new Set(["load","prerender","csr","ssr","trailingSlash","config"]);[...st];const $t=new Set([...st]);[...$t];function jt(a){return a.filter(o=>o!=null)}const Tt="x-sveltekit-invalidated",Ct="x-sveltekit-trailing-slash";function de(a){return a instanceof he||a instanceof je?a.status:500}function Nt(a){return a instanceof je?a.text:"Internal Error"}const W=Ce(nt)??{},ne=Ce(at,ut)??{},re=Ce(rt)??{},Xe=history.pushState,pe=history.replaceState;function Ie(a){W[a]=$e()}function Qe(a,o){let f=a+1;for(;W[f];)delete W[f],f+=1;for(f=o+1;re[f];)delete re[f],f+=1}function Y(a){return location.href=a.href,new Promise(()=>{})}function Ze(){}function Dt(a,o){const f=Ot(a),s=a.nodes[0],l=a.nodes[1];s(),l();const m=document.documentElement,w=[],g=[];let b=null;const v={before_navigate:[],on_navigate:[],after_navigate:[]};let p={branch:[],error:null,url:null},$=!1,O=!1,L=!0,I=!1,D=!1,q=!1,X=!1,oe=!1,H,U=history.state?.[K],N=history.state?.[J];U||(U=N=Date.now(),pe.call(history,{...history.state,[K]:U,[J]:N},"",location.href));const _e=W[U];_e&&(history.scrollRestoration="manual",scrollTo(_e.x,_e.y));let k,B,ge;async function Ne(){if(await(ge||=Promise.resolve()),!ge)return;ge=null;const t=Z(p.url,!0);b=null;const e=B={},n=t&&await ye(t);e===B&&(n&&(n.type==="redirect"?await se(new URL(n.location,p.url).href,{},1,e):(n.props.page!==void 0&&(k=n.props.page),H.$set(n.props))),w.length=0)}function De(t){g.some(e=>e?.snapshot)&&(re[t]=g.map(e=>e?.snapshot?.capture()))}function Fe(t){re[t]?.forEach((e,n)=>{g[n]?.snapshot?.restore(e)})}function He(){Ie(U),Ue(nt,W),De(N),Ue(rt,re),Ue(at,ne,dt)}async function se(t,e,n,r){return le({type:"goto",url:te(t),keepfocus:e.keepFocus,noscroll:e.noScroll,replace_state:e.replaceState,redirect_count:n,nav_token:r,accept:()=>{e.invalidateAll&&(oe=!0)}})}async function qe(t){return b={id:t.id,promise:ye(t).then(e=>(e.type==="loaded"&&e.state.error&&(b=null),e))},b.promise}async function ie(t){const e=f.find(n=>n.exec(Ge(t)));e&&await Promise.all([...e.layouts,e.leaf].map(n=>n?.[1]()))}function Me(t){p=t.state;const e=document.querySelector("style[data-sveltekit]");e&&e.remove(),k=t.props.page,H=new a.root({target:o,props:{...t.props,stores:V,components:g},hydrate:!0}),Fe(N);const n={from:null,to:{params:p.params,route:{id:p.route?.id??null},url:new URL(location.href)},willUnload:!1,type:"enter",complete:Promise.resolve()};v.after_navigate.forEach(r=>r(n)),O=!0}async function Q({url:t,params:e,branch:n,status:r,error:i,route:c,form:u}){let d="never";for(const x of n)x?.slash!==void 0&&(d=x.slash);t.pathname=ht(t.pathname,d),t.search=t.search;const y={type:"loaded",state:{url:t,params:e,branch:n,error:i,route:c},props:{constructors:jt(n).map(x=>x.node.component),page:k}};u!==void 0&&(y.props.form=u);let h={},A=!k,P=0;for(let x=0;x<Math.max(n.length,p.branch.length);x+=1){const S=n[x],j=p.branch[x];S?.data!==j?.data&&(A=!0),S&&(h={...h,...S.data},A&&(y.props[`data_${P}`]=h),P+=1)}return(!p.url||t.href!==p.url.href||p.error!==i||u!==void 0&&u!==k.form||A)&&(y.props.page={error:i,params:e,route:{id:c?.id??null},state:{},status:r,url:new URL(t),form:u??null,data:A?h:k.data}),y}async function me({loader:t,parent:e,url:n,params:r,route:i,server_data_node:c}){let u=null,d=!0;const y={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},h=await t();if(h.universal?.load){let A=function(..._){for(const x of _){const{href:S}=new URL(x,n);y.dependencies.add(S)}};const P={route:new Proxy(i,{get:(_,x)=>(d&&(y.route=!0),_[x])}),params:new Proxy(r,{get:(_,x)=>(d&&y.params.add(x),_[x])}),data:c?.data??null,url:vt(n,()=>{d&&(y.url=!0)},_=>{d&&y.search_params.add(_)}),async fetch(_,x){let S;_ instanceof Request?(S=_.url,x={body:_.method==="GET"||_.method==="HEAD"?void 0:await _.blob(),cache:_.cache,credentials:_.credentials,headers:_.headers,integrity:_.integrity,keepalive:_.keepalive,method:_.method,mode:_.mode,redirect:_.redirect,referrer:_.referrer,referrerPolicy:_.referrerPolicy,signal:_.signal,...x}):S=_;const j=new URL(S,n);return d&&A(j.href),j.origin===n.origin&&(S=j.href.slice(n.origin.length)),O?Rt(S,j.href,x):At(S,x)},setHeaders:()=>{},depends:A,parent(){return d&&(y.parent=!0),e()},untrack(_){d=!1;try{return _()}finally{d=!0}}};u=await h.universal.load.call(null,P)??null}return{node:h,loader:t,server:c,universal:h.universal?.load?{type:"data",data:u,uses:y}:null,data:u??c?.data??null,slash:F&&(n.pathname===F||n.pathname===F+"/")?"always":h.universal?.trailingSlash??c?.slash}}function Ke(t,e,n,r,i,c){if(oe)return!0;if(!i)return!1;if(i.parent&&t||i.route&&e||i.url&&n)return!0;for(const u of i.search_params)if(r.has(u))return!0;for(const u of i.params)if(c[u]!==p.params[u])return!0;for(const u of i.dependencies)if(w.some(d=>d(new URL(u))))return!0;return!1}function ve(t,e){return t?.type==="data"?t:t?.type==="skip"?e??null:null}function ct(t,e){if(!t)return new Set(e.searchParams.keys());const n=new Set([...t.searchParams.keys(),...e.searchParams.keys()]);for(const r of n){const i=t.searchParams.getAll(r),c=e.searchParams.getAll(r);i.every(u=>c.includes(u))&&c.every(u=>i.includes(u))&&n.delete(r)}return n}async function ye({id:t,invalidating:e,url:n,params:r,route:i}){if(b?.id===t)return b.promise;const{errors:c,layouts:u,leaf:d}=i,y=[...u,d];c.forEach(E=>E?.().catch(()=>{})),y.forEach(E=>E?.[1]().catch(()=>{}));let h=null;const A=p.url?t!==p.url.pathname+p.url.search:!1,P=p.route?i.id!==p.route.id:!1,_=ct(p.url,n);let x=!1;const S=y.map((E,R)=>{const T=p.branch[R],C=!!E?.[0]&&(T?.loader!==E[1]||Ke(x,P,A,_,T.server?.uses,r));return C&&(x=!0),C});if(S.some(Boolean)){try{h=await et(n,S)}catch(E){return ce({status:de(E),error:await ee(E,{url:n,params:r,route:{id:i.id}}),url:n,route:i})}if(h.type==="redirect")return h}const j=h?.nodes;let M=!1;const G=y.map(async(E,R)=>{if(!E)return;const T=p.branch[R],C=j?.[R];if((!C||C.type==="skip")&&E[1]===T?.loader&&!Ke(M,P,A,_,T.universal?.uses,r))return T;if(M=!0,C?.type==="error")throw C;return me({loader:E[1],url:n,params:r,route:i,parent:async()=>{const we={};for(let be=0;be<R;be+=1)Object.assign(we,(await G[be])?.data);return we},server_data_node:ve(C===void 0&&E[0]?{type:"skip"}:C??null,E[0]?T?.server:void 0)})});for(const E of G)E.catch(()=>{});const z=[];for(let E=0;E<y.length;E+=1)if(y[E])try{z.push(await G[E])}catch(R){if(R instanceof Ye)return{type:"redirect",location:R.location};let T=de(R),C;if(j?.includes(R))T=R.status??T,C=R.error;else if(R instanceof he)C=R.body;else{if(await V.updated.check())return await Y(n);C=await ee(R,{params:r,url:n,route:{id:i.id}})}const fe=await Ve(E,z,c);return fe?await Q({url:n,params:r,branch:z.slice(0,fe.idx).concat(fe.node),status:T,error:C,route:i}):await Je(n,{id:i.id},C,T)}else z.push(void 0);return await Q({url:n,params:r,branch:z,status:200,error:null,route:i,form:e?void 0:null})}async function Ve(t,e,n){for(;t--;)if(n[t]){let r=t;for(;!e[r];)r-=1;try{return{idx:r+1,node:{node:await n[t](),loader:n[t],data:{},server:null,universal:null}}}catch{continue}}}async function ce({status:t,error:e,url:n,route:r}){const i={};let c=null;if(a.server_loads[0]===0)try{const h=await et(n,[!0]);if(h.type!=="data"||h.nodes[0]&&h.nodes[0].type!=="data")throw 0;c=h.nodes[0]??null}catch{(n.origin!==xe||n.pathname!==location.pathname||$)&&await Y(n)}const d=await me({loader:s,url:n,params:i,route:r,parent:()=>Promise.resolve({}),server_data_node:ve(c)}),y={node:await l(),loader:l,universal:null,server:null,data:null};return await Q({url:n,params:i,branch:[d,y],status:t,error:e,route:null})}function Z(t,e){if(ke(t,F))return;const n=Ge(t.pathname);for(const r of f){const i=r.exec(n);if(i)return{id:t.pathname+t.search,invalidating:e,route:r,params:gt(i),url:t}}}function Ge(t){return _t(t.slice(F.length)||"/")}function ze({url:t,type:e,intent:n,delta:r}){let i=!1;const c=tt(p,n,t,e);r!==void 0&&(c.navigation.delta=r);const u={...c.navigation,cancel:()=>{i=!0,c.reject(new Error("navigation was cancelled"))}};return D||v.before_navigate.forEach(d=>d(u)),i?null:c}async function le({type:t,url:e,popped:n,keepfocus:r,noscroll:i,replace_state:c,redirect_count:u=0,nav_token:d={},accept:y=Ze,block:h=Ze}){const A=Z(e,!1),P=ze({url:e,type:t,delta:n?.delta,intent:A});if(!P){h();return}const _=U,x=N;y(),D=!0,O&&V.navigating.set(P.navigation),B=d;let S=A&&await ye(A);if(!S){if(ke(e,F))return await Y(e);S=await Je(e,{id:null},await ee(new je(404,"Not Found",`Not found: ${e.pathname}`),{url:e,params:{},route:{id:null}}),404)}if(e=A?.url||e,B!==d)return P.reject(new Error("navigation was aborted")),!1;if(S.type==="redirect")if(u>=20)S=await ce({status:500,error:await ee(new Error("Redirect loop"),{url:e,params:{},route:{id:null}}),url:e,route:{id:null}});else return se(new URL(S.location,e).href,{},u+1,d),!1;else S.props.page.status>=400&&await V.updated.check()&&await Y(e);w.length=0,oe=!1,I=!0,Ie(_),De(x),S.props.page.url.pathname!==e.pathname&&(e.pathname=S.props.page.url.pathname);const j=n?n.state:{};if(!n){const E=c?0:1,R={[K]:U+=E,[J]:N+=E};(c?pe:Xe).call(history,R,"",e),c||Qe(U,N)}if(ne[U]=j,b=null,S.props.page.state=j,O){p=S.state,S.props.page&&(S.props.page.url=e);const E=(await Promise.all(v.on_navigate.map(R=>R(P.navigation)))).filter(R=>typeof R=="function");if(E.length>0){let R=function(){v.after_navigate=v.after_navigate.filter(T=>!E.includes(T))};E.push(R),v.after_navigate.push(...E)}H.$set(S.props),X=!0}else Me(S);const{activeElement:M}=document;await Ee();const G=n?n.scroll:i?$e():null;if(L){const E=e.hash&&document.getElementById(decodeURIComponent(e.hash.slice(1)));G?scrollTo(G.x,G.y):E?E.scrollIntoView():scrollTo(0,0)}const z=document.activeElement!==M&&document.activeElement!==document.body;!r&&!z&&Oe(),L=!0,S.props.page&&(k=S.props.page),D=!1,t==="popstate"&&Fe(N),P.fulfil(void 0),v.after_navigate.forEach(E=>E(P.navigation)),V.navigating.set(null),I=!1}async function Je(t,e,n,r){return t.origin===xe&&t.pathname===location.pathname&&!$?await ce({status:r,error:n,url:t,route:e}):await Y(t)}function lt(){let t;m.addEventListener("mousemove",c=>{const u=c.target;clearTimeout(t),t=setTimeout(()=>{r(u,2)},20)});function e(c){r(c.composedPath()[0],1)}m.addEventListener("mousedown",e),m.addEventListener("touchstart",e,{passive:!0});const n=new IntersectionObserver(c=>{for(const u of c)u.isIntersecting&&(ie(u.target.href),n.unobserve(u.target))},{threshold:0});function r(c,u){const d=We(c,m);if(!d)return;const{url:y,external:h,download:A}=Re(d,F);if(h||A)return;const P=ue(d);if(!P.reload)if(u<=P.preload_data){const _=Z(y,!1);_&&qe(_)}else u<=P.preload_code&&ie(y.pathname)}function i(){n.disconnect();for(const c of m.querySelectorAll("a")){const{url:u,external:d,download:y}=Re(c,F);if(d||y)continue;const h=ue(c);h.reload||(h.preload_code===Be.viewport&&n.observe(c),h.preload_code===Be.eager&&ie(u.pathname))}}v.after_navigate.push(i),i()}function ee(t,e){if(t instanceof he)return t.body;const n=de(t),r=Nt(t);return a.hooks.handleError({error:t,event:e,status:n,message:r})??{message:r}}return{after_navigate:t=>{Se(()=>(v.after_navigate.push(t),()=>{const e=v.after_navigate.indexOf(t);v.after_navigate.splice(e,1)}))},before_navigate:t=>{Se(()=>(v.before_navigate.push(t),()=>{const e=v.before_navigate.indexOf(t);v.before_navigate.splice(e,1)}))},on_navigate:t=>{Se(()=>(v.on_navigate.push(t),()=>{const e=v.on_navigate.indexOf(t);v.on_navigate.splice(e,1)}))},disable_scroll_handling:()=>{(I||!O)&&(L=!1)},goto:(t,e={})=>(t=te(t),t.origin!==xe?Promise.reject(new Error("goto: invalid URL")):se(t,e,0)),invalidate:t=>{if(typeof t=="function")w.push(t);else{const{href:e}=new URL(t,location.href);w.push(n=>n.href===e)}return Ne()},invalidate_all:()=>(oe=!0,Ne()),preload_data:async t=>{const e=te(t),n=Z(e,!1);if(!n)throw new Error(`Attempted to preload a URL that does not belong to this app: ${e}`);const r=await qe(n);if(r.type==="redirect")return{type:r.type,location:r.location};const{status:i,data:c}=r.props.page??k;return{type:r.type,status:i,data:c}},preload_code:t=>ie(t),push_state:(t,e)=>{const n={[K]:U+=1,[J]:N,[Ae]:k.url.href};Xe.call(history,n,"",te(t)),k={...k,state:e},H.$set({page:k}),ne[U]=e,Qe(U,N)},replace_state:(t,e)=>{const n={[K]:U,[J]:N,[Ae]:k.url.href};pe.call(history,n,"",te(t)),k={...k,state:e},H.$set({page:k}),ne[U]=e},apply_action:async t=>{if(t.type==="error"){const e=new URL(location.href),{branch:n,route:r}=p;if(!r)return;const i=await Ve(p.branch.length,n,r.errors);if(i){const c=await Q({url:e,params:p.params,branch:n.slice(0,i.idx).concat(i.node),status:t.status??500,error:t.error,route:r});p=c.state,H.$set(c.props),Ee().then(Oe)}}else t.type==="redirect"?se(t.location,{invalidateAll:!0},0):(H.$set({form:null,page:{...k,form:t.data,status:t.status}}),await Ee(),H.$set({form:t.data}),t.type==="success"&&Oe())},_start_router:()=>{history.scrollRestoration="manual",addEventListener("beforeunload",e=>{let n=!1;if(He(),!D){const r=tt(p,void 0,null,"leave"),i={...r.navigation,cancel:()=>{n=!0,r.reject(new Error("navigation was cancelled"))}};v.before_navigate.forEach(c=>c(i))}n?(e.preventDefault(),e.returnValue=""):history.scrollRestoration="auto"}),addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&He()}),navigator.connection?.saveData||lt(),m.addEventListener("click",e=>{if(e.button||e.which!==1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.defaultPrevented)return;const n=We(e.composedPath()[0],m);if(!n)return;const{url:r,external:i,target:c,download:u}=Re(n,F);if(!r)return;if(c==="_parent"||c==="_top"){if(window.parent!==window)return}else if(c&&c!=="_self")return;const d=ue(n);if(!(n instanceof SVGAElement)&&r.protocol!==location.protocol&&!(r.protocol==="https:"||r.protocol==="http:")||u)return;if(i||d.reload){ze({url:r,type:"link"})?D=!0:e.preventDefault();return}const[h,A]=r.href.split("#");if(A!==void 0&&h===Pe(location)){if(p.url.hash===r.hash){e.preventDefault(),n.ownerDocument.getElementById(A)?.scrollIntoView();return}if(q=!0,Ie(U),t(r),!d.replace_state)return;q=!1}e.preventDefault(),le({type:"link",url:r,keepfocus:d.keepfocus,noscroll:d.noscroll,replace_state:d.replace_state??r.href===location.href})}),m.addEventListener("submit",e=>{if(e.defaultPrevented)return;const n=HTMLFormElement.prototype.cloneNode.call(e.target),r=e.submitter;if((r?.formMethod||n.method)!=="get")return;const c=new URL(r?.hasAttribute("formaction")&&r?.formAction||n.action);if(ke(c,F))return;const u=e.target,d=ue(u);if(d.reload)return;e.preventDefault(),e.stopPropagation();const y=new FormData(u),h=r?.getAttribute("name");h&&y.append(h,r?.getAttribute("value")??""),c.search=new URLSearchParams(y).toString(),le({type:"form",url:c,keepfocus:d.keepfocus,noscroll:d.noscroll,replace_state:d.replace_state??c.href===location.href})}),addEventListener("popstate",async e=>{if(e.state?.[K]){const n=e.state[K];if(B={},n===U)return;const r=W[n],i=ne[n]??{},c=new URL(e.state[Ae]??location.href),u=e.state[J],d=Pe(location)===Pe(p.url);if(u===N&&(X||d)){t(c),W[U]=$e(),r&&scrollTo(r.x,r.y),i!==k.state&&(k={...k,state:i},H.$set({page:k})),U=n;return}const h=n-U;await le({type:"popstate",url:c,popped:{state:i,scroll:r,delta:h},accept:()=>{U=n,N=u},block:()=>{history.go(-h)},nav_token:B})}else if(!q){const n=new URL(location.href);t(n)}}),addEventListener("hashchange",()=>{q&&(q=!1,pe.call(history,{...history.state,[K]:++U,[J]:N},"",location.href))});for(const e of document.querySelectorAll("link"))e.rel==="icon"&&(e.href=e.href);addEventListener("pageshow",e=>{e.persisted&&V.navigating.set(null)});function t(e){p.url=e,V.page.set({...k,url:e}),V.page.notify()}},_hydrate:async({status:t=200,error:e,node_ids:n,params:r,route:i,data:c,form:u})=>{$=!0;const d=new URL(location.href);({params:r={},route:i={id:null}}=Z(d,!1)||{});let y;try{const h=n.map(async(_,x)=>{const S=c[x];return S?.uses&&(S.uses=it(S.uses)),me({loader:a.nodes[_],url:d,params:r,route:i,parent:async()=>{const j={};for(let M=0;M<x;M+=1)Object.assign(j,(await h[M]).data);return j},server_data_node:ve(S)})}),A=await Promise.all(h),P=f.find(({id:_})=>_===i.id);if(P){const _=P.layouts;for(let x=0;x<_.length;x++)_[x]||A.splice(x,0,void 0)}y=await Q({url:d,params:r,branch:A,status:t,error:e,form:u,route:P??null})}catch(h){if(h instanceof Ye){await Y(new URL(h.location,location.href));return}y=await ce({status:de(h),error:await ee(h,{url:d,params:r,route:i}),url:d,route:i})}y.props.page&&(y.props.page.state={}),Me(y)}}}async function et(a,o){const f=new URL(a);f.pathname=St(a.pathname),a.pathname.endsWith("/")&&f.searchParams.append(Ct,"1"),f.searchParams.append(Tt,o.map(l=>l?"1":"0").join(""));const s=await ot(f.href);if(!s.ok){let l;throw s.headers.get("content-type")?.includes("application/json")?l=await s.json():s.status===404?l="Not Found":s.status===500&&(l="Internal Error"),new he(s.status,l)}return new Promise(async l=>{const m=new Map,w=s.body.getReader(),g=new TextDecoder;function b(p){return pt(p,{Promise:$=>new Promise((O,L)=>{m.set($,{fulfil:O,reject:L})})})}let v="";for(;;){const{done:p,value:$}=await w.read();if(p&&!v)break;for(v+=!$&&v?`
`:g.decode($);;){const O=v.indexOf(`
`);if(O===-1)break;const L=JSON.parse(v.slice(0,O));if(v=v.slice(O+1),L.type==="redirect")return l(L);if(L.type==="data")L.nodes?.forEach(I=>{I?.type==="data"&&(I.uses=it(I.uses),I.data=b(I.data))}),l(L);else if(L.type==="chunk"){const{id:I,data:D,error:q}=L,X=m.get(I);m.delete(I),q?X.reject(b(q)):X.fulfil(b(D))}}}})}function it(a){return{dependencies:new Set(a?.dependencies??[]),params:new Set(a?.params??[]),parent:!!a?.parent,route:!!a?.route,url:!!a?.url,search_params:new Set(a?.search_params??[])}}function Oe(){const a=document.querySelector("[autofocus]");if(a)a.focus();else{const o=document.body,f=o.getAttribute("tabindex");o.tabIndex=-1,o.focus({preventScroll:!0,focusVisible:!1}),f!==null?o.setAttribute("tabindex",f):o.removeAttribute("tabindex");const s=getSelection();if(s&&s.type!=="None"){const l=[];for(let m=0;m<s.rangeCount;m+=1)l.push(s.getRangeAt(m));setTimeout(()=>{if(s.rangeCount===l.length){for(let m=0;m<s.rangeCount;m+=1){const w=l[m],g=s.getRangeAt(m);if(w.commonAncestorContainer!==g.commonAncestorContainer||w.startContainer!==g.startContainer||w.endContainer!==g.endContainer||w.startOffset!==g.startOffset||w.endOffset!==g.endOffset)return}s.removeAllRanges()}})}}}function tt(a,o,f,s){let l,m;const w=new Promise((b,v)=>{l=b,m=v});return w.catch(()=>{}),{navigation:{from:{params:a.params,route:{id:a.route?.id??null},url:a.url},to:f&&{params:o?.params??null,route:{id:o?.route?.id??null},url:f},willUnload:!o,type:s,complete:w},fulfil:l,reject:m}}async function Kt(a,o,f){const s=Dt(a,o);ft({client:s}),f?await s._hydrate(f):s.goto(location.href,{replaceState:!0}),s._start_router()}export{Kt as start};
