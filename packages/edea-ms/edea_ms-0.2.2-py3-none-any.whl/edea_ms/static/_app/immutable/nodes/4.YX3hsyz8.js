import{e as le}from"../chunks/index.NkaAmagH.js";import{s as se,f as h,a as D,g as b,h as A,d,c as U,Z as O,j as y,i as C,B as _,I as R,r as S,P as we,L as K,Y as $e,l as Y,m as Z,n as fe,e as be}from"../chunks/scheduler.E6X4giYD.js";import{S as oe,i as re,b as Q,d as ee,m as te,a as M,t as q,e as ne,c as ve,g as ge}from"../chunks/index.2ZayTLG1.js";import{h as ke}from"../chunks/ProgressBar.svelte_svelte_type_style_lang.TlH1isqv.js";import{c as N,a as ce,S as xe}from"../chunks/SimpleTable.Mhm7UeVQ.js";import{w as Se,m as je}from"../chunks/singletons.YLCiVgCN.js";import{g as Te}from"../chunks/stores.Bq-lVNKW.js";import{I as ye,P as Pe,T as Ne}from"../chunks/Icon.ptINUyjr.js";import{g as Ee}from"../chunks/stores.b2dq-8-1.js";const Ie=async({fetch:r,params:e})=>{const n=await r("/api/projects/"+e.slug).then(t=>(t.ok||le(t.status,t.statusText),t.json()));return{testruns:r("/api/testruns/project/"+n.id).then(t=>(t.ok||le(t.status,t.statusText),t.json())),specifications:r("/api/specifications/project/"+n.id).then(t=>(t.ok||le(t.status,t.statusText),t.json())),project:n}},it=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"})),V=Se([]),ue=Se(new Set);function De(r){let e,n,t,o,s,a="Edit",p,f,k,l,i,c,w="Delete",T,u,E;return t=new ye({props:{size:"12",src:Pe}}),l=new ye({props:{size:"12",src:Ne}}),{c(){e=h("button"),n=h("span"),Q(t.$$.fragment),o=D(),s=h("span"),s.textContent=a,p=D(),f=h("button"),k=h("span"),Q(l.$$.fragment),i=D(),c=h("span"),c.textContent=w,this.h()},l(v){e=b(v,"BUTTON",{class:!0});var I=A(e);n=b(I,"SPAN",{});var L=A(n);ee(t.$$.fragment,L),L.forEach(d),o=U(I),s=b(I,"SPAN",{"data-svelte-h":!0}),O(s)!=="svelte-bi7592"&&(s.textContent=a),I.forEach(d),p=U(v),f=b(v,"BUTTON",{class:!0});var $=A(f);k=b($,"SPAN",{});var W=A(k);ee(l.$$.fragment,W),W.forEach(d),i=U($),c=b($,"SPAN",{"data-svelte-h":!0}),O(c)!=="svelte-gz26bx"&&(c.textContent=w),$.forEach(d),this.h()},h(){y(e,"class","chip variant-soft hover:variant-filled"),y(f,"class","chip variant-soft hover:variant-filled")},m(v,I){C(v,e,I),_(e,n),te(t,n,null),_(e,o),_(e,s),C(v,p,I),C(v,f,I),_(f,k),te(l,k,null),_(f,i),_(f,c),T=!0,u||(E=[R(e,"click",r[1]),R(f,"click",r[0])],u=!0)},p:S,i(v){T||(M(t.$$.fragment,v),M(l.$$.fragment,v),T=!0)},o(v){q(t.$$.fragment,v),q(l.$$.fragment,v),T=!1},d(v){v&&(d(e),d(p),d(f)),ne(t),ne(l),u=!1,we(E)}}}function Ue(r,e,n){let t;K(r,V,l=>n(3,t=l));let{row:o}=e;const s=Te(),a=Ee();async function p(l){try{const i=new Headers;i.append("X-WebAuth-User","default");const c=await fetch("/api/specifications/"+l,{method:"DELETE",headers:i});if(c.ok){const w={message:"Specification deleted",background:"variant-filled-success"};a.trigger(w);let T=t.findIndex(u=>u.id==l);t.splice(T,1),V.set(t)}else{const w={message:"An error occured: "+c.statusText,background:"variant-filled-error",timeout:5e3};a.trigger(w)}}catch(i){const c={message:"An error occured while sending the request to the server: "+i,background:"variant-filled-error",autohide:!1};a.trigger(c)}}async function f(l){const c={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+o.name+'"',response:async w=>{w&&await p(o.id)}};s.trigger(c)}async function k(l){const i={type:"component",title:"Updating Specification "+o.name,body:"",meta:{row:o,method:"PUT"},component:"modalSpecificationForm",response:async c=>{if(c){let w=t.findIndex(T=>T.id==c.id);$e(V,t[w]=c,t),V.set(t),s.close()}}};s.trigger(i)}return r.$$set=l=>{"row"in l&&n(2,o=l.row)},[f,k,o]}class Ae extends oe{constructor(e){super(),re(this,e,Ue,De,se,{row:2})}}function Oe(r){let e,n=r[0].id+"",t,o;return{c(){e=h("a"),t=Y(n),this.h()},l(s){e=b(s,"A",{href:!0});var a=A(e);t=Z(a,n),a.forEach(d),this.h()},h(){y(e,"href",o="/testrun/"+r[0].id)},m(s,a){C(s,e,a),_(e,t)},p(s,[a]){a&1&&n!==(n=s[0].id+"")&&fe(t,n),a&1&&o!==(o="/testrun/"+s[0].id)&&y(e,"href",o)},i:S,o:S,d(s){s&&d(e)}}}function ze(r,e,n){let{row:t}=e;return r.$$set=o=>{"row"in o&&n(0,t=o.row)},[t]}class Be extends oe{constructor(e){super(),re(this,e,ze,Oe,se,{row:0})}}function He(r){let e;return{c(){e=h("input"),this.h()},l(n){e=b(n,"INPUT",{class:!0,type:!0}),this.h()},h(){y(e,"class","checkbox"),y(e,"type","checkbox"),e.disabled=!0},m(n,t){C(n,e,t)},p:S,d(n){n&&d(e)}}}function Me(r){let e,n,t;return{c(){e=h("input"),this.h()},l(o){e=b(o,"INPUT",{class:!0,type:!0}),this.h()},h(){y(e,"class","checkbox"),y(e,"type","checkbox")},m(o,s){C(o,e,s),e.checked=r[0],n||(t=[R(e,"change",r[4]),R(e,"change",r[2])],n=!0)},p(o,s){s&1&&(e.checked=o[0])},d(o){o&&d(e),n=!1,we(t)}}}function qe(r){let e;function n(s,a){return s[1]?Me:He}let o=n(r)(r);return{c(){o.c(),e=be()},l(s){o.l(s),e=be()},m(s,a){o.m(s,a),C(s,e,a)},p(s,[a]){o.p(s,a)},i:S,o:S,d(s){s&&d(e),o.d(s)}}}function Ve(r,e,n){let{row:t}=e,o=!!t.data?.vega_lite,s=!1;function a(){s?ue.update(f=>f.add(t.id)):ue.update(f=>(f.delete(t.id),f))}function p(){s=this.checked,n(0,s)}return r.$$set=f=>{"row"in f&&n(3,t=f.row)},[s,o,a,t,p]}class Fe extends oe{constructor(e){super(),re(this,e,Ve,qe,se,{row:3})}}function Ce(r){let e,n=r[0].project.number+"",t,o;return{c(){e=Y("("),t=Y(n),o=Y(")")},l(s){e=Z(s,"("),t=Z(s,n),o=Z(s,")")},m(s,a){C(s,e,a),C(s,t,a),C(s,o,a)},p(s,a){a&1&&n!==(n=s[0].project.number+"")&&fe(t,n)},d(s){s&&(d(e),d(t),d(o))}}}function Le(r){let e,n="No testruns available.";return{c(){e=h("p"),e.textContent=n},l(t){e=b(t,"P",{"data-svelte-h":!0}),O(e)!=="svelte-19qnwi6"&&(e.textContent=n)},m(t,o){C(t,e,o)},p:S,i:S,o:S,d(t){t&&d(e)}}}function Re(r){let e,n,t,o="Only testruns with charts can be compared for now.",s,a,p;function f(i,c){return i[1].size>1?Xe:We}let k=f(r),l=k(r);return a=new xe({props:{data:r[4],columns:r[6],rowsPerPage:10}}),a.$on("selected",r[9]),{c(){e=h("div"),l.c(),n=D(),t=h("p"),t.textContent=o,s=D(),Q(a.$$.fragment)},l(i){e=b(i,"DIV",{});var c=A(e);l.l(c),n=U(c),t=b(c,"P",{"data-svelte-h":!0}),O(t)!=="svelte-cw2v9o"&&(t.textContent=o),c.forEach(d),s=U(i),ee(a.$$.fragment,i)},m(i,c){C(i,e,c),l.m(e,null),_(e,n),_(e,t),C(i,s,c),te(a,i,c),p=!0},p(i,c){k===(k=f(i))&&l?l.p(i,c):(l.d(1),l=k(i),l&&(l.c(),l.m(e,n)))},i(i){p||(M(a.$$.fragment,i),p=!0)},o(i){q(a.$$.fragment,i),p=!1},d(i){i&&(d(e),d(s)),l.d(),ne(a,i)}}}function We(r){let e,n="Compare Selected";return{c(){e=h("button"),e.textContent=n,this.h()},l(t){e=b(t,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-v41ftl"&&(e.textContent=n),this.h()},h(){y(e,"class","btn variant-filled"),e.disabled=!0},m(t,o){C(t,e,o)},p:S,d(t){t&&d(e)}}}function Xe(r){let e,n="Compare Selected",t,o;return{c(){e=h("button"),e.textContent=n,this.h()},l(s){e=b(s,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-19z10pc"&&(e.textContent=n),this.h()},h(){y(e,"class","btn variant-filled")},m(s,a){C(s,e,a),t||(o=R(e,"click",r[8]),t=!0)},p:S,d(s){s&&d(e),t=!1,o()}}}function Ye(r){let e,n="No specification data available.";return{c(){e=h("p"),e.textContent=n},l(t){e=b(t,"P",{"data-svelte-h":!0}),O(e)!=="svelte-1ancpzf"&&(e.textContent=n)},m(t,o){C(t,e,o)},p:S,i:S,o:S,d(t){t&&d(e)}}}function Ze(r){let e,n;return e=new xe({props:{data:V,columns:r[5],rowsPerPage:10}}),{c(){Q(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,o){te(e,t,o),n=!0},p:S,i(t){n||(M(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Ge(r){let e,n,t=r[0].project.name+"",o,s,a,p,f="Testruns",k,l,i,c,w,T,u,E,v,I="Specifications",L,$,W="New",ae,j,P,X,ie,de,x=r[0].project.number&&Ce(r);const pe=[Re,Le],z=[];function me(m,g){return m[3].length>0?0:1}l=me(r),i=z[l]=pe[l](r);const _e=[Ze,Ye],B=[];function he(m,g){return m[2].length>0?0:1}return j=he(r),P=B[j]=_e[j](r),{c(){e=h("div"),n=h("h1"),o=Y(t),x&&x.c(),s=D(),a=h("section"),p=h("h2"),p.textContent=f,k=D(),i.c(),c=D(),w=h("hr"),T=D(),u=h("section"),E=h("div"),v=h("h2"),v.textContent=I,L=D(),$=h("button"),$.textContent=W,ae=D(),P.c(),this.h()},l(m){e=b(m,"DIV",{class:!0});var g=A(e);n=b(g,"H1",{class:!0});var F=A(n);o=Z(F,t),x&&x.l(F),F.forEach(d),s=U(g),a=b(g,"SECTION",{class:!0});var H=A(a);p=b(H,"H2",{class:!0,"data-svelte-h":!0}),O(p)!=="svelte-uwi6xt"&&(p.textContent=f),k=U(H),i.l(H),H.forEach(d),c=U(g),w=b(g,"HR",{}),T=U(g),u=b(g,"SECTION",{class:!0});var G=A(u);E=b(G,"DIV",{class:!0});var J=A(E);v=b(J,"H2",{class:!0,"data-svelte-h":!0}),O(v)!=="svelte-lqesz5"&&(v.textContent=I),L=U(J),$=b(J,"BUTTON",{class:!0,"data-svelte-h":!0}),O($)!=="svelte-g87gly"&&($.textContent=W),J.forEach(d),ae=U(G),P.l(G),G.forEach(d),g.forEach(d),this.h()},h(){y(n,"class","h1"),y(p,"class","h2"),y(a,"class","space-y-2"),y(v,"class","h2"),y($,"class","btn variant-filled"),y(E,"class","flex justify-between"),y(u,"class","space-y-2"),y(e,"class","container mx-auto p-8 space-y-8")},m(m,g){C(m,e,g),_(e,n),_(n,o),x&&x.m(n,null),_(e,s),_(e,a),_(a,p),_(a,k),z[l].m(a,null),_(e,c),_(e,w),_(e,T),_(e,u),_(u,E),_(E,v),_(E,L),_(E,$),_(u,ae),B[j].m(u,null),X=!0,ie||(de=R($,"click",r[7]),ie=!0)},p(m,[g]){(!X||g&1)&&t!==(t=m[0].project.name+"")&&fe(o,t),m[0].project.number?x?x.p(m,g):(x=Ce(m),x.c(),x.m(n,null)):x&&(x.d(1),x=null);let F=l;l=me(m),l===F?z[l].p(m,g):(ge(),q(z[F],1,1,()=>{z[F]=null}),ve(),i=z[l],i?i.p(m,g):(i=z[l]=pe[l](m),i.c()),M(i,1),i.m(a,null));let H=j;j=he(m),j===H?B[j].p(m,g):(ge(),q(B[H],1,1,()=>{B[H]=null}),ve(),P=B[j],P?P.p(m,g):(P=B[j]=_e[j](m),P.c()),M(P,1),P.m(u,null))},i(m){X||(M(i),M(P),X=!0)},o(m){q(i),q(P),X=!1},d(m){m&&d(e),x&&x.d(),z[l].d(),B[j].d(),ie=!1,de()}}}function Je(r,e,n){let t,o,s;K(r,ue,u=>n(1,t=u)),K(r,V,u=>n(2,o=u));let{data:a}=e;const p=Te();V.set(a.specifications);let f=je(a.testruns);K(r,f,u=>n(3,s=u));const k=[N("id","ID"),N("project_id","Project ID"),N("name","Name"),N("minimum","Minimum"),N("typical","Typical"),N("maximum","Maximum"),N("unit","Unit"),ce("Actions",Ae)],l=[ce("Select",Fe),ce("ID",Be),N("short_code","Short code"),N("dut_id","DUT ID"),N("machine_hostname","Machine Hostname"),N("user_name","Username"),N("test_name","Test Name")],i={type:"component",title:"New specification for "+a.project.name,body:"",meta:{project_id:a.project.id},component:"modalSpecificationForm",response:async u=>{u&&(o.push(u),V.set(o),p.close())}};function c(){p.trigger(i)}function w(){let u=Array.from(t.values());ke(`/project/compare?id=${a.project.id}&testruns=${u.join()}`)}function T(u){ke(`/testrun/${u.detail.id}`)}return r.$$set=u=>{"data"in u&&n(0,a=u.data)},[a,t,o,s,f,k,l,c,w,T]}class lt extends oe{constructor(e){super(),re(this,e,Je,Ge,se,{data:0})}}export{lt as component,it as universal};
