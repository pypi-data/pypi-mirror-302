Metadata-Version: 2.1
Name: CFNCFSP
Version: 1.1
Summary: Empower your workflow with our toolkit: Word Segmentation with target word search, Frame Identification, Argument Identification and Role Identification. Chain these functions in a flexible pipeline, allowing users to search for all target words or specify their own, delivering tailored results.
Author: 
Author-email: 
Description-Content-Type: text/markdown
Requires-Dist: pydantic ==2.4.2
Requires-Dist: torch ==1.13.1
Requires-Dist: transformers ==4.24.0
Requires-Dist: ltp ==4.2.13

| Language                             | version |
| ------------------------------------ | ------- |
| [Python](python/interface/README.md) | â‰¥3.7    |

# CFSP

ä½¿ç”¨æˆ‘ä»¬çš„å·¥å…·åŒ…CFSPæ¥åˆ†ææ‚¨è¾“å…¥çš„å¤šæ¡è¯­å¥ï¼ŒCFSPå°†åˆ†è¯ä¸ç›®æ ‡è¯æœç´¢ã€æ¡†æ¶è¯†åˆ«ã€è®ºå…ƒèŒƒå›´è¯†åˆ«å’Œè®ºå…ƒè§’è‰²è¯†åˆ«è¿™äº›åŠŸèƒ½é“¾æ¥åœ¨ä¸€ä¸ªpipelineå‡½æ•°ä¸­ï¼Œç”¨æˆ·æ ¹æ®è‡ªèº«éœ€è¦æŒ‡å®šä»»åŠ¡ï¼Œç¨‹åºå°†é¡ºåºæ‰§è¡Œå‰ç½®ä»»åŠ¡åŠç›¸åº”ä»»åŠ¡ï¼Œä»¥jsonç»“æ„è¿”å›ç»“æœã€‚

## ä¸€.å®‰è£…

æ­¤é¡¹ç›®çš„æ‰€æœ‰åŠŸèƒ½è¿›è¡Œäº†æµ‹è¯•ã€‚ CFSPå¯ä»¥é€šè¿‡pipç›´æ¥ä¸‹è½½ï¼š

```shell
pip install CFNCFSP
```

æˆ–è€…é€‰æ‹©é€šè¿‡æºä»£ç ç›´æ¥å®‰è£…ï¼š

```shell
git clone https://github.com/laaaaazyman/CFSP.git
cd CFSP
pip install .
```

## äºŒ.æ¨¡å‹åŠä¸‹è½½åœ°å€

|                   åˆ†è¯æ¨¡å‹                   | æ¡†æ¶è¯†åˆ«æ¨¡å‹ | è®ºå…ƒèŒƒå›´è¯†åˆ«æ¨¡å‹ | è®ºå…ƒè§’è‰²è¯†åˆ«æ¨¡å‹ |
| :------------------------------------------: | :----------: | :--------------: | :--------------: |
| [ğŸ¤—LTP/Base](https://huggingface.co/LTP/base) | ğŸ¤—[SXUCFN/CFNParser-FI](https://huggingface.co/SXUCFN/CFNParser-FI) | ğŸ¤—[SXUCFN/CFNParser-AI](https://huggingface.co/SXUCFN/CFNParser-AI) |         ğŸ¤—[SXUCFN/CFNParser-RI](https://huggingface.co/SXUCFN/CFNParser-RI)         |

## ä¸‰.å¿«é€Ÿå¼€å§‹

### æä¾›æ¨¡å‹è·¯å¾„ï¼Œåˆ›å»ºåå³å¯ä½¿ç”¨

```python
from CFNCFSP import CFNParser
# Step 1 : åˆ›å»ºCFSPå¯¹è±¡
# é»˜è®¤ huggingface ä¸‹è½½ï¼Œå¯èƒ½éœ€è¦ä»£ç†
tool = CFNParser() #ä½¿ç”¨é»˜è®¤å‚æ•°ï¼Œç­‰æ•ˆäºä¸‹æ–¹ä»£ç 
tool = CFNParser(	 ws_pretrained_model_name_or_pat = 'LTP/base', 
		    	 fi_pretrained_model_name_or_path = '...',
		       	 ai_pretrained_model_name_or_path = '...',
			     ri_pretrained_model_name_or_path = '...',
		    	 device = 'cpu',
		    	 n = 10, # nå³è¿”å›æœ€æœ‰å¯èƒ½çš„nä¸ªç»“æœï¼Œé»˜è®¤ä¸º10
)

# ç»™å‡ºæ¨¡å‹ä¸‹è½½æˆ–è§£å‹åçš„è·¯å¾„
tool = CFNParser(	 ws_pretrained_model_name_or_pat = path/to/ltpbase, 
		    	 fi_pretrained_model_name_or_path = path/to/fi,
		    	 ai_pretrained_model_name_or_path = path/to/ai,
		    	 ri_pretrained_model_name_or_path = path/to/ri,
)

# Step 2 : æŒ‡å®šè¾“å…¥å¥å­ï¼Œå¯ä»¥æ˜¯stræˆ–è€…List[str]æˆ–è€…å‰ç½®ä»»åŠ¡è¿”å›çš„ç»“æœ
sentences = [
			'æ ¹æ®å»ºè®¾éƒ¨çš„è§„å®šï¼Œå‡¡å±äºå›½é™…é‡‘èç»„ç»‡è´·æ¬¾å¹¶ç”±å›½é™…å…¬å¼€æ‹›æ ‡çš„å·¥ç¨‹å…¨éƒ¨ç”±å¤–å›½æŠ•èµ„æˆ–èµ æ¬¾å»ºè®¾çš„å·¥ç¨‹ï¼Œä»¥åŠå›½å†…ä¼ä¸šåœ¨æŠ€æœ¯ä¸Šéš¾ä»¥å•ç‹¬æ‰¿åŒ…çš„ä¸­å¤–åˆèµ„å»ºè®¾å·¥ç¨‹ï¼Œå¢ƒå¤–å»ºç­‘ä¼ä¸šåœ¨å–å¾—ä¸­å›½å®¡æ‰¹çš„å¤–å›½ä¼ä¸šæ‰¿åŒ…å·¥ç¨‹èµ„è´¨è¯åï¼Œçš†å¯è¿›å…¥ä¸­å›½å¢ƒå†…æ‰¿åŒ…å»ºè®¾ç›®ã€‚',
			'åˆ°å»å¹´åº•ï¼Œå…¨åŒºå„é¡¹å­˜æ¬¾ä½™é¢è¾¾ä¸ƒåä¸€ç‚¹å…­ä¸‰äº¿å…ƒï¼Œæ¯”ä¸Šå¹´åŒæœŸå¢é•¿ç™¾åˆ†ä¹‹å››åä¸€ç‚¹ä¸ƒå…«ï¼Œå…¶ä¸­ï¼ŒåŸä¹¡å±…æ°‘å‚¨è“„å­˜æ¬¾ä¸ºåä¹ç‚¹ä¸‰ä¸ƒäº¿å…ƒï¼Œæ¯”ä¸Šå¹´åŒæœŸå¢é•¿ç™¾åˆ†ä¹‹å››åå…«ç‚¹äºŒã€‚',
    			'ä»Šå¤©æ˜¯ä¸ªå¥½æ—¥å­ï¼Œå¿ƒæƒ³çš„äº‹å„¿éƒ½èƒ½æˆã€‚'
]


# Step 3 : æ‰§è¡Œæ‹Ÿå®šä»»åŠ¡
# åˆ†è¯å¹¶ä¸”æ‰¾ç›®æ ‡è¯WSã€æ¡†æ¶è¯†åˆ«FIã€è®ºå…ƒèŒƒå›´è¯†åˆ«AIå’Œè®ºå…ƒè§’è‰²è¯†åˆ«RI(taskså‡½æ•°ä¸æŒ‡å®šæ—¶ï¼Œç­‰åŒäºtasks = ['RI']ï¼Œç­‰åŒäºé¡ºåºæ‰§è¡Œ'WS', 'FI', 'AI', 'RI'æ‰€æœ‰ä»»åŠ¡)
# å½“ä¸æŒ‡å®štargetså‚æ•°æ—¶ï¼Œç­‰åŒäºå¯»æ‰¾æ‰€æœ‰ç›®æ ‡è¯
res = tool.pipeline(sentences, tasks = ['RI'])

# Step 4 : ä»¥jsonæ ¼å¼è¾“å‡º
for i in res:
	print(i)
```

### ç»“æœæ ·ä¾‹ï¼š

```python
{
    "sentence": (json)å¥å­ä¿¡æ¯--ç”±textå’Œwordsç»„æˆä¸€ä¸ªå…ƒç´ 
    {
        "text": (str)åŸå¥å­,
        "words": (List[json])ltpåˆ†è¯ç»“æœçš„ç»“æ„åŒ–è¡¨ç¤º
		[
        	{
        		"word": (str)è¯,
        		"pos": (json)è¯çš„è¯æ€§ä¿¡æ¯
					{
               			"POS_id": (int)è¯æ€§id,
                   		"POS_name": (str)è¯æ€§åç§°,
                   		"POS_mark": (str)è¯æ€§æ ‡è¯†ç¬¦å·
               		}
			}
		]
    }
    "parsing": (List(json))æ¡†æ¶ä¿¡æ¯--ç”±targetå’Œargumentsç»„æˆä¸€ä¸ªå…ƒç´ 
	[
        {
            "target": (json)ç›®æ ‡è¯ä¿¡æ¯
            {
                "word": (str)ç›®æ ‡è¯,
                "pos": (json)ç›®æ ‡è¯çš„è¯æ€§ä¿¡æ¯
            	{
                    "POS_id": (int)è¯æ€§id,
                    "POS_name": (str)è¯æ€§åç§°,
                    "POS_mark": (str)è¯æ€§æ ‡è¯†ç¬¦å·
                },
                "start": (int)ç›®æ ‡è¯èµ·å§‹ä½ç½®(ç´¢å¼•ä»0å¼€å§‹),
                "end": (int)ç›®æ ‡è¯ç»“æŸä½ç½®(ç´¢å¼•ä»0å¼€å§‹),
                "frame": (json)æ¨¡å‹è¾“å‡ºå¾—åˆ†æœ€é«˜çš„æ¡†æ¶ä¿¡æ¯:
        		{
                    "frame_id": (int)æ¡†æ¶id,
                    "frame_name": (str)æ¡†æ¶åç§°
                },
                "frame_with_scores": (List(json))å‰©ä½™n - 1ä¸ªå¯èƒ½åŒ¹é…çš„æ¡†æ¶çš„ä¿¡æ¯
				[
                    {
                        "frame_id": (int)æ¡†æ¶id,
                        "frame_name": (str)æ¡†æ¶åç§°,
                        "score": (float)æ¨¡å‹å¯¹åº”å¾—åˆ†
                    },
					{
                        ...
                    },
                    ...
                ]
            },
            "arguments": (List(json))æ¡†æ¶å¯¹åº”è®ºå…ƒä¿¡æ¯--ç”±start/end/fe/fe_with_scoreç»„æˆä¸€ä¸ªå…ƒç´ 
			[
                {
                    "start": (int)è®ºå…ƒèµ·å§‹ä½ç½®(ç´¢å¼•ä»0å¼€å§‹),
                    "end": (int)è®ºå…ƒç»“æŸä½ç½®(ç´¢å¼•ä»0å¼€å§‹),
                    "fe":{
                        "fe_id": (int)è®ºå…ƒè§’è‰²id,
                        "fe_name": (str)è®ºå…ƒè§’è‰²åç§°,
                        "fe_abbr": (str)è®ºå…ƒè§’è‰²ç¼©å†™
                    },
                    "fe_with_score": (List(json))å‰©ä½™n - 1ä¸ªå¯èƒ½åŒ¹é…çš„è®ºå…ƒè§’è‰²çš„ä¿¡æ¯
					[
                        {
                            "fe_id": (int)è®ºå…ƒè§’è‰²id,
                            "fe_name": (str)è®ºå…ƒè§’è‰²åç§°,
                            "fe_abbr": (str)è®ºå…ƒè§’è‰²ç¼©å†™,
                            "score": (float)æ¨¡å‹å¯¹åº”å¾—åˆ†
                        },
						{
                            ...
                        },
						...                            
                    ]
                }
            ]
        }
}
```

## å››.pipelineå‡½æ•°å‚æ•°targetsä½¿ç”¨è¯´æ˜

### 1.ä¸æŒ‡å®š ï¼š é»˜è®¤æ‰¾å¯»å¥å­ä¸­å…¨éƒ¨ç›®æ ‡è¯è¿›è¡Œåç»­æ“ä½œ

```python
res = tool.pipeline(sentences, tasks = ['RI'])
# except print : 
# ç¬¬ä¸€å¥çš„ 'å±äº'(10-11); 'å»ºè®¾'(41-42); 'å»ºè®¾'(68-69); 'å–å¾—'(80-81); 'å®¡æ‰¹'(84-85); 'è¿›å…¥'(102-103); 'å»ºè®¾'(110-111) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
# ç¬¬äºŒå¥çš„ 'è¾¾'(13-13); 'å¢é•¿'(28-29); 'ä¸º'(51-51); 'å¢é•¿'(65-66) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
# ç¬¬ä¸‰å¥çš„ 'æ˜¯'(2-2); 'æˆ'(15-15) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
```

### 2.targetsä½¿ç”¨å•ä¸ªå­—ç¬¦è¿›è¡ŒæŒ‡å®š ï¼š æ‰€æœ‰å¥å­éƒ½æŸ¥æ‰¾æ­¤ç›®æ ‡è¯

```python
tar = 'å»ºè®¾'
res = tool.pipeline(sentences, tasks = ['RI'],targets = tar)
# except print : 
# ç¬¬ä¸€å¥çš„ 'å»ºè®¾'(41-42); 'å»ºè®¾'(68-69); 'å»ºè®¾'(110-111) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
# ç¬¬äºŒå¥æ— å¯¹åº”ç›®æ ‡è¯(å³parsingä¸º[])
# ç¬¬ä¸‰å¥æ— å¯¹åº”ç›®æ ‡è¯(å³parsingä¸º[])
```

### 3.targetsä½¿ç”¨ä¸sentencesç­‰é•¿å­—ç¬¦åˆ—è¡¨è¿›è¡ŒæŒ‡å®š ï¼š å…ƒç´ ä¸€ä¸€å¯¹åº”è¿›è¡ŒæŸ¥æ‰¾

```python
tar = [['å»ºè®¾', 'å±äº'], ['å­˜æ¬¾', 'è¾¾'], 'æˆ']
res = tool.pipeline(sentences, tasks = ['RI'],targets = tar)
# except print : 
# ç¬¬ä¸€å¥çš„ 'å±äº'(10-11); 'å»ºè®¾'(41-42); 'å»ºè®¾'(68-69); 'å»ºè®¾'(110-111) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
# ç¬¬äºŒå¥çš„ 'è¾¾'(13-13) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡('å­˜æ¬¾'ä¸åœ¨ç›®æ ‡è¯æ–‡æ¡£ä¸­ï¼Œä¸æŸ¥æ‰¾)
# ç¬¬ä¸‰å¥çš„ 'æˆ'(15-15) ä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
```

### 4.targetsä½¿ç”¨ç´¢å¼•è¿›è¡ŒæŒ‡å®š ï¼š

```python
tar = [[[2, 3], [10, 11]], [13, 13], [2, 2]]
res = tool.pipeline(sentences, tasks = ['RI'],targets = tar)
# except print : 
# ç¬¬ä¸€å¥çš„ (10-11)ï¼šå±äºï¼Œä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
# ç¬¬äºŒå¥çš„ (13-13) ï¼šè¾¾ï¼Œä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
# ç¬¬ä¸‰å¥çš„ (2-2) ï¼šæ˜¯ï¼Œä½œç›®æ ‡è¯å±•å¼€åç»­ä»»åŠ¡
```

å…¶ä½™æƒ…å†µå¦‚ç»™å®šå¥å­æ•°ä¸æŒ‡å®štargetsåˆ—è¡¨é•¿åº¦ä¸ç­‰é•¿ï¼Œå°†å¯¼è‡´ç¨‹åºæŠ¥é”™æ— æ³•è¿è¡Œã€‚
