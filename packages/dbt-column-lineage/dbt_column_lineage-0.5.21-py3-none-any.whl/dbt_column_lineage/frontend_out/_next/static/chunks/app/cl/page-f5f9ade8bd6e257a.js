(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{38127:function(e,t,s){Promise.resolve().then(s.bind(s,23023))},23023:function(e,t,s){"use strict";s.d(t,{Cl:function(){return T}});var a=s(57437),o=s(16463),r=s(2265),l=s(6785),n=s(71165);let i=e=>{let{getNodes:t,setNodes:s,getEdges:a,setEdges:o}=(0,l._K)(),i=(0,l.Bn)(),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)([]),[m,x]=(0,r.useState)(),[p,g]=(0,r.useState)(),f=(0,n.o)(e=>e.setLoading),b=(0,n.o)(e=>e.showColumn),y=(0,n.o)(e=>e.setClearNodePosition),w=(0,n.o)(e=>e.leftMaxDepth),j=(0,n.o)(e=>e.rightMaxDepth),v=(0,r.useCallback)((e,t)=>{let s=new Map(e.map(e=>[e.id,e]));return t.forEach(e=>{if(s.has(e.id)){let t=s.get(e.id);s.set(e.id,{...t,data:{...t.data,...e.data,columns:Array.from(new Set([...t.data.columns,...e.data.columns]))}})}else s.set(e.id,e)}),Array.from(s.values())},[]),N=(0,r.useCallback)((e,t)=>{let s=new Map(e.map(e=>[e.id,e]));return t.forEach(e=>{s.has(e.id)||s.set(e.id,e)}),Array.from(s.values())},[]),C=(0,r.useCallback)(async(e,r,l)=>{f(!0);let n=JSON.stringify({[r]:[l]}),i=new URLSearchParams({sources:r,columns:n,depth:"1",show_column:b.toString(),reverse:"true"});j?i.set("depth","-1"):i.set("depth","1");let c=await fetch("".concat("","/api/v1/lineage?").concat(i)),u=await c.json();if(f(!1),200!=c.status){alert(u.error);return}if(0==u.edges.length){b?d(e=>[...e,l]):x(r);return}let h=v(t(),u.nodes),m=N(a(),u.edges);s(h),o(m),y(!0)},[t,a,b,j]),k=(0,r.useCallback)(async(e,r)=>{f(!0);let l=JSON.stringify({[e]:[r]}),n=new URLSearchParams({sources:e,columns:l,depth:"1",show_column:b.toString()});w?n.set("depth","-1"):n.set("depth","1");let i=await fetch("".concat("","/api/v1/lineage?").concat(n)),c=await i.json();if(f(!1),200!=i.status){alert(c.error);return}if(0==c.edges.length){b?h(e=>[...e,r]):g(e);return}let d=v(t(),c.nodes),u=N(a(),c.edges);s(d),o(u),y(!0)},[t,a,b,i,w]),L=(0,r.useCallback)(()=>{let t=[e];s(e=>e.filter(e=>!t.includes(e.id))),o(e=>e.filter(e=>!t.includes(e.source)&&!t.includes(e.target))),y(!0)},[e,s,o]),S=(0,r.useCallback)(e=>{let t={};return e.forEach(e=>{t[e.target]||(t[e.target]={}),e.targetHandle&&(t[e.target][e.targetHandle]=(t[e.target][e.targetHandle]||0)+1)}),Object.entries(t).filter(e=>{let[t,s]=e;return Object.values(s).some(e=>e>=2)}).map(e=>{let[t]=e;return t})},[]),_=(0,r.useCallback)((e,t)=>{let s=t.filter(t=>t.source===e).map(e=>e.target),a=S(t),o=s.filter(e=>!a.includes(e)),r=o.flatMap(e=>_(e,t));return[...o,...r]},[a]),P=(0,r.useCallback)((e,r)=>{let n=_(e,a()),i=[e,...n],c=new Map,d=new Set;a().forEach(t=>{if(t.fixed&&d.add(t.target),i.includes(t.source)&&i.includes(t.target)){var s,a;let o=c.get(t.source)||new Set,l=c.get(t.target)||new Set,n=(null===(s=t.sourceHandle)||void 0===s?void 0:s.split("__")[0])||"",i=(null===(a=t.targetHandle)||void 0===a?void 0:a.split("__")[0])||"",d=t.source===e&&n===r,u=o.has(n);(d||u)&&(l.add(i),c.set(t.target,l))}}),s(t=>t.map(e=>{if(!i.includes(e.id))return e;let t=c.get(e.id)||new Set,s=e.data.columns.filter(e=>!t.has(e));return{...e,data:{...e.data,columns:s}}}).filter(t=>t.id===e||t.data.columns.length>0||d.has(t.id))),o(s=>(0,l.my)(t(),s).filter(t=>{var s;return t.source!=e||(null===(s=t.sourceHandle)||void 0===s?void 0:s.split("__")[0])!=r})),y(!0)},[b,s,o,_,t,a]),E=(0,r.useCallback)(r=>{let n=_(r,a());s(e=>e.filter(e=>!n.includes(e.id))),o(s=>(0,l.my)(t(),s).filter(t=>t.source!=e&&!n.includes(t.source))),y(!0)},[_,t,a]);return{addReverseLineage:C,addSingleLineage:k,hideNode:L,getDescendantNodes:_,hideColumnAndRelatedEdges:P,hideTableAndRelatedEdges:E,lastNodeColumns:c,lastNodeTable:m,firstNodeColumns:u,firstNodeTable:p}};var c=s(6920),d=s(45079),u=(0,r.memo)(e=>{let{type:t,position:s,id:o,isConnectable:r,nodeId:i,onDelete:u,onConnect:h}=e,m=(0,l.oR)(e=>e.edges),x=(0,n.o)(e=>e.loading),p=m.some(e=>"target"===t&&e.target===i&&e.targetHandle===o||"source"===t&&e.source===i&&e.sourceHandle===o);return(0,a.jsxs)("div",{style:{position:"absolute",[s===l.Ly.Left?"left":"right"]:"-2px",top:"50%",transform:"translateY(-50%)",zIndex:1},children:[(0,a.jsx)(l.HH,{type:t,position:s,id:o,isConnectable:r,style:{opacity:0,width:"24px",height:"24px",background:"transparent",border:"none"}}),(0,a.jsx)("button",{className:"w-6 h-6 flex items-center justify-center bg-white rounded-full border border-gray-300 hover:bg-gray-100 focus:outline-none",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"auto",cursor:"source"===t&&p?"pointer":"default"},onClick:e=>{x||(e.stopPropagation(),"source"===t&&p?u():p||h(t))},children:"source"===t&&p?(0,a.jsx)(c.G,{icon:d.Kl4,className:"text-gray-600"}):p?(0,a.jsx)("span",{className:"w-4 h-4"}):(0,a.jsx)(c.G,{icon:x?d.LM3:d.r8p,spinPulse:x,className:"text-gray-600"})})]})}),h=s(1970),m=s(49354),x=(0,r.memo)(e=>{let{schema:t,tableName:s,selected:l,materialized:i,isClickableTableName:u,content:x,hideNode:p}=e,g=(0,n.o)(e=>e.setMessage),f=(0,o.useSearchParams)(),[b,y]=(0,r.useState)(!1),w=(0,r.useCallback)(e=>{e.stopPropagation();let a=new URLSearchParams({schema:t,sources:s,activeSource:s});window.open("/cte?".concat(a.toString()),"_blank")},[t,s]),j=(0,r.useCallback)(async e=>{e.stopPropagation();try{await navigator.clipboard.writeText(s),g("Copied to clipboard!","success"),setTimeout(()=>g(null,null),3e3)}catch(e){console.error("Failed to copy text: ",e)}},[s]),v=(0,r.useCallback)(e=>{e.stopPropagation(),p()},[p]),N=(0,r.useCallback)(()=>f.get("source")!==s,[f,s]),C=(0,m.C)(i);return(0,a.jsxs)("div",{className:"\n        flex flex-col bg-white \n        transition-all duration-250 ease-in-out\n        ".concat(l?"shadow-lg":"shadow-md","\n        border-0 border-solid border-gray-300\n        text-sm\n      "),children:[(0,a.jsxs)("div",{className:"relative py-2 px-3 flex items-center justify-between ".concat(C),children:[(0,a.jsx)("div",{className:"flex-grow mr-2 overflow-hidden text-ellipsis",children:u?(0,a.jsx)("span",{className:"cursor-pointer hover:underline",onClick:w,title:s,children:s}):(0,a.jsx)("span",{title:s,children:s})}),(0,a.jsxs)("div",{className:"flex-shrink-0 flex items-center",children:[(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("button",{className:"p-1 rounded-full hover:bg-gray-200 focus:outline-none",onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:(0,a.jsx)(c.G,{icon:d.iV1})}),b&&(0,a.jsx)("div",{className:"absolute right-0 top-0 bg-white rounded-md shadow-lg z-10 whitespace-nowrap",style:{transform:"translate(5%, -90%)"},onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:(0,a.jsx)("div",{className:"py-1",children:(0,a.jsxs)("button",{onClick:j,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",title:"Copy table name",children:[(0,a.jsx)(c.G,{icon:h.kZ_,className:"mr-2"}),"Copy table name"]})})})]}),N()&&(0,a.jsx)("button",{onClick:v,className:"p-1 ml-2 rounded-full hover:bg-gray-200 focus:outline-none",title:"Hide node",children:(0,a.jsx)(c.G,{icon:d.NBC})})]})]}),(0,a.jsx)("div",{className:"",children:x})]})}),p=e=>{let{schema:t,tableName:s,nodeColumns:o,handlePlusClickEventNodeHandle:l}=e,[n,i]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[m,x]=(0,r.useState)([]),[p,g]=(0,r.useState)(null),f=(0,r.useRef)(null),b=(0,r.useRef)(null),y=(0,r.useCallback)(async()=>{if(!(m.length>0)&&!n){i(!0);try{let e=new URLSearchParams({schema:t,source:s}),a=await fetch("".concat("","/api/v1/columns?").concat(e)),r=await a.json(),l=new Set(o.map(e=>e.toLowerCase())),n=r.filter(e=>!l.has(e.value.toLowerCase()));x(n)}catch(e){console.error("Error fetching columns:",e)}finally{i(!1)}}},[t,s,o,n,i]),w=(0,r.useCallback)(()=>{h(e=>{let t=!e;return t&&y(),t})},[y]),j=(0,r.useCallback)(async e=>{!n&&(await l(e.value,"source"),x(t=>t.filter(t=>t.value!==e.value)),b.current&&g(b.current.offsetWidth))},[n,l]);return(0,r.useEffect)(()=>{b.current&&g(b.current.offsetWidth)},[]),(0,a.jsxs)("div",{ref:b,children:[(0,a.jsx)("div",{className:"mt-2 border-t pt-2 flex justify-center",children:(0,a.jsx)("button",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none",onClick:w,"aria-label":u?"Collapse columns":"Expand columns",children:(0,a.jsx)(c.G,{icon:u?d.mTx:d.ptq,className:"text-gray-600"})})}),u&&p&&(0,a.jsx)("div",{ref:f,className:"nowheel mt-2 max-h-60 overflow-y-auto pr-4 scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200",style:{width:"".concat(p,"px"),overflow:"auto"},onWheel:e=>e.stopPropagation(),children:n?(0,a.jsx)("p",{className:"text-center",children:"Loading columns..."}):m.length>0?(0,a.jsx)("ul",{className:"list-none p-0 m-0",children:m.map(e=>(0,a.jsxs)("li",{className:"flex flex-col relative cursor-pointer hover:bg-gray-100 transition-colors duration-200 py-2 px-6",onClick:()=>j(e),children:[(0,a.jsx)("span",{className:"hover:underline flex-grow truncate",children:e.label}),e.description&&(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1 truncate",title:e.description,children:e.description})]},e.value))}):(0,a.jsx)("p",{className:"text-center text-gray-500",children:"All columns have been selected."})})]})},g=(0,r.memo)(e=>{let{type:t,position:s,id:o,isConnectable:r,nodeId:i,onConnect:u,onDelete:h}=e,m=(0,l.oR)(e=>e.edges),x=(0,n.o)(e=>e.loading),p=m.some(e=>"target"===t&&e.target===i&&e.targetHandle===o||"source"===t&&e.source===i&&e.sourceHandle===o),g={position:"absolute",top:"22px",transform:"translateY(-50%)",...s===l.Ly.Left?{left:"-2px"}:{right:"-2px"},zIndex:1};return(0,a.jsxs)("div",{style:g,children:[(0,a.jsx)(l.HH,{type:t,position:s,id:o,isConnectable:r,style:{opacity:0,width:"24px",height:"24px",background:"transparent",border:"none"}}),h&&(0,a.jsx)("button",{className:"w-6 h-6 flex items-center justify-center bg-white rounded-full border border-gray-300 hover:bg-gray-100 focus:outline-none",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"auto",cursor:"source"===t&&p?"pointer":"default"},onClick:e=>{x||(e.stopPropagation(),"source"===t&&p&&h?h():!p&&u&&u())},children:"source"===t&&p&&h?(0,a.jsx)(c.G,{icon:d.Kl4,className:"text-gray-600"}):!p&&u?(0,a.jsx)(c.G,{icon:x?d.LM3:d.r8p,spinPulse:x,className:"text-gray-600"}):(0,a.jsx)("span",{className:"w-4 h-4"})})]})});let f=e=>{let{data:t,id:s,selected:o}=e,{addSingleLineage:c,addReverseLineage:d,hideNode:h,hideTableAndRelatedEdges:m,hideColumnAndRelatedEdges:f,lastNodeColumns:b,lastNodeTable:y,firstNodeColumns:w,firstNodeTable:j}=i(s),v=(0,n.o)(e=>e.options),N=(0,n.o)(e=>e.showColumn),C=(0,r.useCallback)((e,s)=>{e.stopPropagation();let{schema:a,name:o}=t,r=JSON.stringify({[o]:[s.toLowerCase()]}),l=new URLSearchParams({schema:a,sources:o,activeSource:o,selectedColumns:r});window.open("/cte?".concat(l.toString()),"_blank")},[t]),k=(0,r.useCallback)(async(e,a)=>{"target"===a?await d(s,t.name,e):"source"===a&&await c(t.name,e)},[d,c,s,t.name]),L=(0,r.useCallback)(e=>{N?f(s,e):m(s)},[N,f,m,s]);return N?(0,a.jsx)(x,{schema:t.schema,tableName:t.name,selected:o,hideNode:h,isClickableTableName:!1,materialized:t.materialized,content:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[j!=t.name&&(0,a.jsx)(g,{type:"source",position:l.Ly.Left,id:"".concat(s,"__source"),isConnectable:!0,nodeId:s}),y!=t.name&&(0,a.jsx)(g,{type:"target",position:l.Ly.Right,id:"".concat(s,"__target"),isConnectable:!0,nodeId:s})]}),(0,a.jsxs)("div",{className:"py-2 px-0",children:[t.columns.map(e=>(0,a.jsxs)("div",{className:"flex items-center relative",style:{position:"relative",padding:"8px 16px",flexGrow:1,textAlign:"left",paddingRight:"24px",paddingLeft:"24px"},children:[(0,a.jsx)("p",{className:"cursor-pointer hover:underline flex-grow",onClick:t=>C(t,e),children:e}),!t.last&&!w.includes(e)&&(0,a.jsx)(u,{type:"source",position:"LR"===v.rankdir?l.Ly.Right:l.Ly.Left,id:"".concat(e,"__source"),isConnectable:!0,nodeId:s,onDelete:()=>L(e),onConnect:()=>k(e,"source")}),!t.first&&!b.includes(e)&&(0,a.jsx)(u,{type:"target",position:"LR"===v.rankdir?l.Ly.Left:l.Ly.Right,id:"".concat(e,"__target"),isConnectable:!0,nodeId:s,onDelete:()=>L(e),onConnect:()=>k(e,"target")})]},"i-"+e)),(0,a.jsx)(p,{schema:t.schema,tableName:t.name,nodeColumns:t.columns,handlePlusClickEventNodeHandle:k})]})]})}):(0,a.jsx)(x,{schema:t.schema,tableName:t.name,selected:o,hideNode:h,isClickableTableName:!0,materialized:t.materialized,content:(0,a.jsxs)(a.Fragment,{children:[j!=t.name&&(0,a.jsx)(g,{type:"source",position:l.Ly.Left,id:"".concat(s,"__source"),isConnectable:!0,nodeId:s,onConnect:()=>k("","source"),onDelete:L}),y!=t.name&&(0,a.jsx)(g,{type:"target",position:l.Ly.Right,id:"".concat(s,"__target"),isConnectable:!0,nodeId:s,onConnect:()=>k("","target"),onDelete:L})]})})};var b=s(27289),y=s(63775),w=s(50197);s(10715);var j=s(29820),v=s.n(j);let N=(e,t,s)=>{let a=new(v()).graphlib.Graph;return a.setDefaultEdgeLabel(()=>({})),a.setGraph(s),t.forEach(e=>a.setEdge(e.source,e.target)),e.forEach(e=>a.setNode(e.id,{label:e.id,width:e.width,height:e.height})),v().layout(a),e.forEach(e=>{let t=a.node(e.id);switch(s.rankdir){case"TB":e.targetPosition=l.Ly.Top,e.sourcePosition=l.Ly.Bottom;break;case"BT":e.targetPosition=l.Ly.Bottom,e.sourcePosition=l.Ly.Top;break;case"LR":e.targetPosition=l.Ly.Left,e.sourcePosition=l.Ly.Right;break;case"RL":e.targetPosition=l.Ly.Right,e.sourcePosition=l.Ly.Left}return e.position={x:t.x-t.width/2+Math.random()/1e3,y:t.y-t.height/2},e}),{nodes:e,edges:t}},C=e=>{let{setNodes:t,setEdges:s,setViewIsFit:i,nodesPositioned:u,setNodesPositioned:h}=e,{fitView:m}=(0,l._K)(),x=(0,l.oR)(e=>e.nodeInternals),p=Array.from(x.values()),g=(0,l.oR)(e=>e.edges),f=(0,l.oR)(e=>e.transform),b=(0,n.o)(e=>e.options),y=(0,n.o)(e=>e.sidebarActive),w=(0,n.o)(e=>e.setSidebarActive),j=(0,o.useRouter)();return(0,r.useCallback)((e,t)=>{let s=new URLSearchParams({schema:e.data.schema,source:e.data.name,column:t});j.push("/cte?".concat(s.toString()))},[x]),(0,r.useEffect)(()=>{try{var e;if((null===(e=p[0])||void 0===e?void 0:e.width)&&p.length>0&&!u){let e=N(p,g,b);console.log("redraw",e),t(e.nodes),s(e.edges),h(!0),window.requestAnimationFrame(()=>{setTimeout(()=>m(),0)}),i(!0)}}catch(e){console.log("error",e)}},[u,p]),(0,a.jsxs)("div",{className:"bg-white drop-shadow-md "+(y?"w-1/6":"w-5"),children:[(0,a.jsx)("div",{className:"px-1",onClick:()=>w(!y),children:(0,a.jsx)(c.G,{icon:y?d.yOZ:d.EyR,className:"h-[20px]"})}),y&&(0,a.jsxs)("div",{className:"px-2 text-sm",children:[(0,a.jsx)("div",{className:"py-1 font-semibold text-base",children:"Zoom & pan transform"}),(0,a.jsxs)("div",{className:"transform break-words",children:["[",f[0].toFixed(2),", ",f[1].toFixed(2),", ",f[2].toFixed(2),"]"]}),(0,a.jsx)("div",{className:"py-1 font-semibold text-base",children:"Nodes"}),p.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium break-words",children:e.data.name}),(0,a.jsxs)("div",{children:["x: ",e.position.x.toFixed(2),", y: ",e.position.y.toFixed(2)]})]},e.id))]})]})};var k=s(37215),L=s(97293),S=s(92222),_=s(50659),P=s(80233),E=()=>{let{getEdges:e,setEdges:t}=(0,l._K)(),s=(0,n.o)(e=>e.showColumn),o=(0,n.o)(e=>e.setShowColumn),i=(0,n.o)(e=>e.setClearNodePosition),c=(0,n.o)(e=>e.columnModeEdges),d=(0,n.o)(e=>e.setColumnModeEdges),u=(0,n.o)(e=>e.setRightMaxDepth),h=(0,n.o)(e=>e.setMessage),[m,x]=(0,r.useState)("column"),p=[{id:"table",icon:S.Z,label:"Table"},{id:"column",icon:_.Z,label:"Column"}];(0,r.useEffect)(()=>{x(s?"column":"table")},[s]);let g=(0,r.useCallback)(s=>{let a="column"===s;o(a);let r=e();if(a){let e=r.map(e=>({...e,fixed:!0,style:{...e.style,strokeDasharray:"5,5",strokeWidth:1.5}}));t(c.concat(e)),u(!1)}else{d(r.filter(e=>!e.fixed));let e=new Map;r.forEach(t=>{let s=t.source,a=t.target,o="".concat(s,"-").concat(a);e.has(o)||e.set(o,{id:o,source:s,target:a,sourceHandle:"".concat(s,"__source"),targetHandle:"".concat(a,"__target")})}),t(Array.from(e.values()))}i(!0)},[e,t,o,i,c]),f=(0,r.useCallback)(async()=>{let e=document.querySelector(".react-flow__viewport"),t=await (0,L.SE)(e,{backgroundColor:"#fff"});if(t)try{let e=[new window.ClipboardItem({"image/png":t})];await navigator.clipboard.write(e);let s=new URLSearchParams(window.location.search).toString();h("Successfully copied to clipboard!:\n\n"+s,"success"),setTimeout(()=>h(null,null),6e3)}catch(e){h("Failed to copy to clipboard","error"),console.error("Failed to copy:",e),setTimeout(()=>h(null,null),3e3)}},[]);return(0,a.jsx)("div",{className:"flex flex-col space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:p.map(e=>(0,a.jsxs)("button",{type:"button",className:"px-4 py-2 text-sm font-medium border flex items-center whitespace-nowrap ".concat(m===e.id?"bg-blue-500 text-white border-blue-600":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"," ").concat(e.id===p[0].id?"rounded-l-lg":e.id===p[p.length-1].id?"rounded-r-lg":""),onClick:()=>g(e.id),children:[(0,a.jsx)(e.icon,{className:"mr-2",size:16}),(0,a.jsx)("span",{children:e.label})]},e.id))}),(0,a.jsxs)("button",{onClick:f,className:"rounded px-4 py-2 text-sm font-medium border bg-blue-500 text-white border-blue-600 flex items-center hover:bg-blue-600 transition-colors duration-200","aria-label":"Copy to clipboard",children:[(0,a.jsx)(P.Z,{className:"mr-2",size:16}),(0,a.jsx)("span",{children:"Copy to clipboard"})]})]})})},R=s(22468),M=s(36127),D=s(30690),H=s(92168),F=s(19997);let T=()=>{let{height:e,width:t}=(0,b.Y)(),[s,i]=(0,l.Rr)([]),[c,d]=(0,l.ll)([]),[u,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)(!0),g=(0,n.o)(e=>e.sidebarActive);(0,n.o)(e=>e.options);let j=(0,n.o)(e=>e.setOptions),v=(0,n.o)(e=>e.clearNodePosition),N=(0,n.o)(e=>e.setClearNodePosition),L=(0,n.o)(e=>e.leftMaxDepth),S=(0,n.o)(e=>e.setLeftMaxDepth),_=(0,n.o)(e=>e.rightMaxDepth),P=(0,n.o)(e=>e.setRightMaxDepth),T=(0,n.o)(e=>e.showColumn),z=(0,n.o)(e=>e.setShowColumn),A=(0,n.o)(e=>e.message),G=(0,n.o)(e=>e.messageType),Z=(0,o.useSearchParams)(),I=(0,r.useCallback)(async e=>{let{sources:t,columns:s,showColumn:a,depth:o}=e;i([]),d([]),z(a);let r=new URLSearchParams({sources:t.join(","),columns:JSON.stringify(s),show_column:a.toString()});Number.isNaN(o)?a?r.append("depth","-1"):r.append("depth","1"):r.set("depth",o.toString());let l=await fetch("".concat("","/api/v1/lineage?").concat(r)),n=await l.json();return 200!=l.status?(alert(n.error),!1):(i(n.nodes),d(n.edges),p(!1),!0)},[Z]),O=(0,r.useCallback)(e=>i(t=>(0,l.Fb)(e,t)),[i]),U=(0,r.useCallback)(e=>d(t=>(0,l.yn)(e,t)),[d]),B=(0,r.useCallback)(e=>d(t=>(0,l.Z_)(e,t)),[d]),K=(0,r.useMemo)(()=>({eventNode:e=>(0,a.jsx)(f,{...e})}),[]);return(0,r.useEffect)(()=>{v&&(N(!1),setTimeout(()=>p(!1),100))},[v]),(0,r.useEffect)(()=>{p(!1)},[g]),(0,r.useEffect)(()=>{j({rankdir:"RL"})},[]),(0,a.jsxs)("div",{children:[(0,a.jsx)(k.h,{handleFetchData:I}),(0,a.jsx)("div",{className:"flex flex-wrap",children:(0,a.jsxs)(l.tV,{children:[(0,a.jsx)("div",{className:g?"w-5/6":"w-[calc(100%-20px)]",style:{height:e-55},children:(0,a.jsxs)(l.x$,{nodes:s,edges:c,onNodesChange:O,onEdgesChange:U,onConnect:B,nodeTypes:K,children:[(0,a.jsx)(l.s_,{position:"top-left",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsx)(E,{}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"leftMaxDepth",type:"checkbox",checked:L,onChange:()=>S(!L),className:"form-checkbox h-4 w-4 text-blue-600 rounded"}),(0,a.jsx)("label",{htmlFor:"leftMaxDepth",className:"ml-2 text-sm text-gray-700",children:"Max depth for left (+) button"})]}),!T&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"rightMaxDepth",type:"checkbox",checked:_,onChange:()=>P(!_),className:"form-checkbox h-4 w-4 text-blue-600 rounded"}),(0,a.jsx)("label",{htmlFor:"rightMaxDepth",className:"ml-2 text-sm text-gray-700",children:"Max depth for right (+) button"})]})]})]})}),(0,a.jsx)(l.s_,{position:"top-right",children:s.length>0&&(0,a.jsx)("div",{className:"p-1 rounded",children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:m.p.map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-4 h-4 mr-1 rounded-sm ".concat((0,m.C)(e))}),(0,a.jsx)("span",{className:"text-[10px] whitespace-nowrap text-gray-700",children:e})]},e))})})}),(0,a.jsx)(y.Z,{}),(0,a.jsx)(w.A,{style:{backgroundColor:"#f5f5f5"}})]})}),(0,a.jsx)(C,{setNodes:i,setEdges:d,setViewIsFit:h,setNodesPositioned:p,nodesPositioned:x})]})}),A&&(0,a.jsxs)("div",{className:"absolute top-4 right-4 px-4 py-3 rounded shadow-md z-50 flex items-center ".concat("success"===G?"bg-green-100 border-green-400 text-green-700":"error"===G?"bg-red-100 border-red-400 text-red-700":"bg-blue-100 border-blue-400 text-blue-700"),role:"alert",children:[(e=>{switch(e){case"success":return(0,a.jsx)(R.Z,{className:"inline-block mr-2",size:20});case"error":return(0,a.jsx)(M.Z,{className:"inline-block mr-2",size:20});default:return(0,a.jsx)(D.Z,{className:"inline-block mr-2",size:20})}})(G),(0,a.jsx)("div",{className:"sm:inline text-xs max-w-xl",children:(0,a.jsx)(H.U,{className:"markdown",remarkPlugins:[F.Z],children:A})})]})]})}}},function(e){e.O(0,[489,780,676,346,586,868,971,23,744],function(){return e(e.s=38127)}),_N_E=e.O()}]);