import{s as R,f as v,a as $,g as y,h as P,d as h,c as E,Z as N,j as k,i as S,B as j,I as T,r as x,P as K,L as U,Y as Q,x as W}from"../chunks/scheduler.398aa708.js";import{S as V,i as Y,b as z,d as B,m as q,a as A,t as I,e as F,c as X,g as ee}from"../chunks/index.d57ec5a8.js";import{h as te}from"../chunks/ProgressBar.svelte_svelte_type_style_lang.ce11150a.js";import{c as O,a as ne,S as oe}from"../chunks/SimpleTable.5cbf1e41.js";import{g as Z}from"../chunks/stores.320a51a4.js";import{I as G,P as se,T as re}from"../chunks/Icon.c5962984.js";import{g as ae}from"../chunks/stores.1138e1f1.js";import{w as J}from"../chunks/singletons.1f51f3a9.js";const le=async({fetch:l,params:e})=>({projects:await(await l("/api/projects")).json()}),Pe=Object.freeze(Object.defineProperty({__proto__:null,load:le},Symbol.toStringTag,{value:"Module"})),C=J([]),ce=J();function ie(l){let e,n,t,u,c,d="Edit",i,s,_,r,f,o,m="Delete",a,p,b;return t=new G({props:{size:"12",src:se}}),r=new G({props:{size:"12",src:re}}),{c(){e=v("button"),n=v("span"),z(t.$$.fragment),u=$(),c=v("span"),c.textContent=d,i=$(),s=v("button"),_=v("span"),z(r.$$.fragment),f=$(),o=v("span"),o.textContent=m,this.h()},l(g){e=y(g,"BUTTON",{class:!0});var w=P(e);n=y(w,"SPAN",{});var L=P(n);B(t.$$.fragment,L),L.forEach(h),u=E(w),c=y(w,"SPAN",{"data-svelte-h":!0}),N(c)!=="svelte-bi7592"&&(c.textContent=d),w.forEach(h),i=E(g),s=y(g,"BUTTON",{class:!0});var D=P(s);_=y(D,"SPAN",{});var M=P(_);B(r.$$.fragment,M),M.forEach(h),f=E(D),o=y(D,"SPAN",{"data-svelte-h":!0}),N(o)!=="svelte-gz26bx"&&(o.textContent=m),D.forEach(h),this.h()},h(){k(e,"class","chip variant-soft hover:variant-filled"),k(s,"class","chip variant-soft hover:variant-filled")},m(g,w){S(g,e,w),j(e,n),q(t,n,null),j(e,u),j(e,c),S(g,i,w),S(g,s,w),j(s,_),q(r,_,null),j(s,f),j(s,o),a=!0,p||(b=[T(e,"click",l[1]),T(e,"keypress",l[1]),T(s,"click",l[0]),T(s,"keypress",l[0])],p=!0)},p:x,i(g){a||(A(t.$$.fragment,g),A(r.$$.fragment,g),a=!0)},o(g){I(t.$$.fragment,g),I(r.$$.fragment,g),a=!1},d(g){g&&(h(e),h(i),h(s)),F(t),F(r),p=!1,K(b)}}}function ue(l,e,n){let t,u;U(l,C,f=>n(3,t=f)),U(l,ce,f=>n(4,u=f));let{row:c}=e;const d=Z(),i=ae();async function s(f){try{const o=await fetch("/api/projects/"+f,{method:"DELETE"});if(o.ok){const m={message:"Project deleted",background:"variant-filled-success"};i.trigger(m);let a=t.findIndex(p=>p.id==f);t.splice(a,1),C.set(t)}else{const m={message:"An error occured: "+o.statusText,background:"variant-filled-error",timeout:5e3};i.trigger(m)}}catch(o){const m={message:"An error occured while sending the request to the server: "+o,background:"variant-filled-error",autohide:!1};i.trigger(m)}}async function _(f){const m={type:"confirm",title:"Please Confirm",body:'Are you sure you want to delete "'+c.name+'"',response:async a=>{a&&await s(c.id)}};d.trigger(m)}async function r(f){const o={type:"component",title:"Updating "+c.name,body:"",meta:{row:c,method:"PUT",groups:u.groups},component:"modalProjectForm",response:async m=>{if(m){let a=t.findIndex(p=>p.id==m.message.id);Q(C,t[a]=m.message,t),C.set(t),d.close()}}};d.trigger(o)}return l.$$set=f=>{"row"in f&&n(2,c=f.row)},[_,r,c]}class fe extends V{constructor(e){super(),Y(this,e,ue,ie,R,{row:2})}}function H(l){let e,n="New",t,u;return{c(){e=v("button"),e.textContent=n,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-32nq53"&&(e.textContent=n),this.h()},h(){k(e,"class","btn bg-gradient-to-br variant-filled")},m(c,d){S(c,e,d),t||(u=T(e,"click",l[4]),t=!0)},p:x,d(c){c&&h(e),t=!1,u()}}}function pe(l){let e,n="No project data available.";return{c(){e=v("p"),e.textContent=n},l(t){e=y(t,"P",{"data-svelte-h":!0}),N(e)!=="svelte-r7a4lf"&&(e.textContent=n)},m(t,u){S(t,e,u)},p:x,i:x,o:x,d(t){t&&h(e)}}}function me(l){let e,n;return e=new oe({props:{data:C,columns:l[3],rowsPerPage:10}}),e.$on("selected",l[5]),{c(){z(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,u){q(e,t,u),n=!0},p:x,i(t){n||(A(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function de(l){let e,n,t,u="Projects",c,d,i,s,_,r=l[1]!==void 0&&H(l);const f=[me,pe],o=[];function m(a,p){return a[0].length>0?0:1}return i=m(l),s=o[i]=f[i](l),{c(){e=v("div"),n=v("section"),t=v("h1"),t.textContent=u,c=$(),r&&r.c(),d=$(),s.c(),this.h()},l(a){e=y(a,"DIV",{class:!0});var p=P(e);n=y(p,"SECTION",{class:!0});var b=P(n);t=y(b,"H1",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-1d00lg2"&&(t.textContent=u),c=E(b),r&&r.l(b),b.forEach(h),d=E(p),s.l(p),p.forEach(h),this.h()},h(){k(t,"class","h1"),k(n,"class","flex justify-between"),k(e,"class","container mx-auto p-8 space-y-8")},m(a,p){S(a,e,p),j(e,n),j(n,t),j(n,c),r&&r.m(n,null),j(e,d),o[i].m(e,null),_=!0},p(a,[p]){a[1]!==void 0?r?r.p(a,p):(r=H(a),r.c(),r.m(n,null)):r&&(r.d(1),r=null);let b=i;i=m(a),i===b?o[i].p(a,p):(ee(),I(o[b],1,1,()=>{o[b]=null}),X(),s=o[i],s?s.p(a,p):(s=o[i]=f[i](a),s.c()),A(s,1),s.m(e,null))},i(a){_||(A(s),_=!0)},o(a){I(s),_=!1},d(a){a&&h(e),r&&r.d(),o[i].d()}}}function ge(l,e,n){let t,u;U(l,C,o=>n(0,t=o));let{data:c}=e;const d=Z();C.set(c.projects);const i=W("user");U(l,i,o=>n(1,u=o));const s=[O("id","ID"),O("short_code","Short Code"),O("name","Name"),O("groups","Groups"),ne("Actions",fe)],_={type:"component",title:"New Project",body:"",meta:{groups:u==null?void 0:u.groups},component:"modalProjectForm",response:async o=>{o&&(t.push(o),C.set(t),d.close())}};function r(){d.trigger(_)}function f(o){te(`/project/${o.detail.id}`)}return l.$$set=o=>{"data"in o&&n(6,c=o.data)},[t,u,i,s,r,f,c]}class ke extends V{constructor(e){super(),Y(this,e,ge,de,R,{data:6})}}export{ke as component,Pe as universal};
