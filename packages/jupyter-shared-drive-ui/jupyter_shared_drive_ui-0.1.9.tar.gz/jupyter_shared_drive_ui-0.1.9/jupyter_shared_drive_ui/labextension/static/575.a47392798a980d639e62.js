"use strict";(self.webpackChunk_jupyter_shared_drive_extension=self.webpackChunk_jupyter_shared_drive_extension||[]).push([[575],{575:(t,e,s)=>{s.d(e,{ww:()=>f});const r=Date.now,a=Math.floor,n=(Math.ceil,Math.abs,Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,Number.isNaN,Math.pow,Math.sign,()=>new Map),i=()=>new Set,o=Array.from;Array.isArray;class h{constructor(){this._observers=n()}on(t,e){((t,e,s)=>{let r=t.get(e);return void 0===r&&t.set(e,r=s()),r})(this._observers,t,i).add(e)}once(t,e){const s=(...r)=>{this.off(t,s),e(...r)};this.on(t,s)}off(t,e){const s=this._observers.get(t);void 0!==s&&(s.delete(e),0===s.size&&this._observers.delete(t))}emit(t,e){return o((this._observers.get(t)||n()).values()).forEach((t=>t(...e)))}destroy(){this._observers=n()}}Object.assign;const l=Object.keys,c=t=>l(t).length,u=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),d=(Object.freeze,(t,e)=>{if(null==t||null==e)return((t,e)=>t===e)(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:if(t.byteLength!==e.byteLength)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;break;case Set:if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;break;case Map:if(t.size!==e.size)return!1;for(const s of t.keys())if(!e.has(s)||!d(t.get(s),e.get(s)))return!1;break;case Object:if(c(t)!==c(e))return!1;for(const s in t)if(!u(t,s)||!d(t[s],e[s]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!d(t[s],e[s]))return!1;break;default:return!1}return!0});s(206);class f extends h{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const t=r();null!==this.getLocalState()&&15e3<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const e=[];this.meta.forEach(((s,r)=>{r!==this.clientID&&3e4<=t-s.lastUpdated&&this.states.has(r)&&e.push(r)})),e.length>0&&g(this,e,"timeout")}),a(3e3)),t.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const e=this.clientID,s=this.meta.get(e),a=void 0===s?0:s.clock+1,n=this.states.get(e);null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:a,lastUpdated:r()});const i=[],o=[],h=[],l=[];null===t?l.push(e):null==n?null!=t&&i.push(e):(o.push(e),d(n,t)||h.push(e)),(i.length>0||h.length>0||l.length>0)&&this.emit("change",[{added:i,updated:h,removed:l},"local"]),this.emit("update",[{added:i,updated:o,removed:l},"local"])}setLocalStateField(t,e){const s=this.getLocalState();null!==s&&this.setLocalState({...s,[t]:e})}getStates(){return this.states}}const g=(t,e,s)=>{const a=[];for(let s=0;s<e.length;s++){const n=e[s];if(t.states.has(n)){if(t.states.delete(n),n===t.clientID){const e=t.meta.get(n);t.meta.set(n,{clock:e.clock+1,lastUpdated:r()})}a.push(n)}}a.length>0&&(t.emit("change",[{added:[],updated:[],removed:a},s]),t.emit("update",[{added:[],updated:[],removed:a},s]))}}}]);