# This file was auto generated by Styx.
# Do not edit this file directly.

import typing
import pathlib
from styxdefs import *
import dataclasses

FSL_MRSI_METADATA = Metadata(
    id="f461c421877519ddf8d20249fc983f727dc48f55.boutiques",
    name="fsl_mrsi",
    package="fsl",
    container_image_tag="mcin/fsl:6.0.5",
)


class FslMrsiOutputs(typing.NamedTuple):
    """
    Output object returned when calling `fsl_mrsi(...)`.
    """
    root: OutputPathType
    """Output root folder. This is the root folder for all outputs."""


def fsl_mrsi(
    data: InputPathType,
    basis: InputPathType,
    mask: InputPathType,
    output: str,
    algo: str | None = None,
    ignore_metab: list[str] | None = None,
    keep_metab: list[str] | None = None,
    combine_metab: list[str] | None = None,
    ppmlim: list[float] | None = None,
    h2o: InputPathType | None = None,
    baseline_order: float | None = None,
    metab_groups: list[str] | None = None,
    add_mm: bool = False,
    lorentzian: bool = False,
    ind_scale: list[str] | None = None,
    disable_mh_priors: bool = False,
    te: float | None = None,
    tr: float | None = None,
    tissue_frac: list[InputPathType] | None = None,
    internal_ref: list[str] | None = None,
    wref_metabolite: str | None = None,
    ref_protons: float | None = None,
    ref_int_limits: list[float] | None = None,
    h2o_scale: float | None = None,
    report: bool = False,
    verbose: bool = False,
    overwrite: bool = False,
    single_proc: bool = False,
    conj_fid: bool = False,
    no_conj_fid: bool = False,
    conj_basis: bool = False,
    no_conj_basis: bool = False,
    no_rescale: bool = False,
    config: InputPathType | None = None,
    runner: Runner | None = None,
) -> FslMrsiOutputs:
    """
    FSL Magnetic Resonance Spectroscopy Imaging Wrapper Script.
    
    Author: FMRIB Centre
    
    URL: https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/
    
    Args:
        data: Input NIFTI file.
        basis: Basis file or folder.
        mask: Mask volume.
        output: Output folder.
        algo: Algorithm [Newton (fast, default) or MH (slow)].
        ignore_metab: Ignore certain metabolites [repeatable].
        keep_metab: Only keep these metabolites.
        combine_metab: Combine certain metabolites [repeatable].
        ppmlim: Limit the fit to a frequency range.
        h2o: Input .H2O file for quantification.
        baseline_order: Order of baseline polynomial (default=2, -1 disables).
        metab_groups: Metabolite groups: list of groups or list of names for\
            independent groups.
        add_mm: Include default macromolecule peaks.
        lorentzian: Enable purely lorentzian broadening (default is Voigt).
        ind_scale: List of basis spectra to scale independently of other basis\
            spectra.
        disable_mh_priors: Disable MH priors.
        te: Echo time for relaxation correction (ms).
        tr: Repetition time for relaxation correction (s).
        tissue_frac: Tissue fraction NIFTI files registered to MRSI volume.\
            Supplied in order: WM, GM, CSF.
        internal_ref: Metabolite(s) used as an internal reference. Defaults to\
            tCr (Cr+PCr).
        wref_metabolite: Metabolite(s) used as the reference for water scaling.\
            Uses internal defaults otherwise.
        ref_protons: Number of protons that reference metabolite is equivalent\
            to. No effect without setting --wref_metabolite.
        ref_int_limits: Reference spectrum integration limits (low, high). No\
            effect without setting --wref_metabolite.
        h2o_scale: Additional scaling modifier for external water referencing.
        report: Output HTML report.
        verbose: Output verbose information.
        overwrite: Overwrite existing output folder.
        single_proc: Disable parallel processing of voxels.
        conj_fid: Force conjugation of FID.
        no_conj_fid: Forbid automatic conjugation of FID.
        conj_basis: Force conjugation of basis.
        no_conj_basis: Forbid automatic conjugation of basis.
        no_rescale: Forbid rescaling of FID/basis/H2O.
        config: Configuration file.
        runner: Command runner.
    Returns:
        NamedTuple of outputs (described in `FslMrsiOutputs`).
    """
    if tissue_frac is not None and (len(tissue_frac) != 3): 
        raise ValueError(f"Length of 'tissue_frac' must be 3 but was {len(tissue_frac)}")
    runner = runner or get_global_runner()
    execution = runner.start_execution(FSL_MRSI_METADATA)
    cargs = []
    cargs.append("fsl_mrsi")
    cargs.append("--data")
    cargs.append(execution.input_file(data))
    cargs.append("--basis")
    cargs.append(execution.input_file(basis))
    cargs.append("--mask")
    cargs.append(execution.input_file(mask))
    cargs.append("--output")
    cargs.append(output)
    if algo is not None:
        cargs.extend([
            "--algo",
            algo
        ])
    if ignore_metab is not None:
        cargs.extend([
            "--ignore",
            *ignore_metab
        ])
    if keep_metab is not None:
        cargs.extend([
            "--keep",
            *keep_metab
        ])
    if combine_metab is not None:
        cargs.extend([
            "--combine",
            *combine_metab
        ])
    if ppmlim is not None:
        cargs.extend([
            "--ppmlim",
            *map(str, ppmlim)
        ])
    if h2o is not None:
        cargs.extend([
            "--h2o",
            execution.input_file(h2o)
        ])
    if baseline_order is not None:
        cargs.extend([
            "--baseline_order",
            str(baseline_order)
        ])
    if metab_groups is not None:
        cargs.extend([
            "--metab_groups",
            *metab_groups
        ])
    if add_mm:
        cargs.append("--add_MM")
    if lorentzian:
        cargs.append("--lorentzian")
    if ind_scale is not None:
        cargs.extend([
            "--ind_scale",
            *ind_scale
        ])
    if disable_mh_priors:
        cargs.append("--disable_MH_priors")
    if te is not None:
        cargs.extend([
            "--TE",
            str(te)
        ])
    if tr is not None:
        cargs.extend([
            "--TR",
            str(tr)
        ])
    if tissue_frac is not None:
        cargs.extend([
            "--tissue_frac",
            *[execution.input_file(f) for f in tissue_frac]
        ])
    if internal_ref is not None:
        cargs.extend([
            "--internal_ref",
            *internal_ref
        ])
    if wref_metabolite is not None:
        cargs.extend([
            "--wref_metabolite",
            wref_metabolite
        ])
    if ref_protons is not None:
        cargs.extend([
            "--ref_protons",
            str(ref_protons)
        ])
    if ref_int_limits is not None:
        cargs.extend([
            "--ref_int_limits",
            *map(str, ref_int_limits)
        ])
    if h2o_scale is not None:
        cargs.extend([
            "--h2o_scale",
            str(h2o_scale)
        ])
    if report:
        cargs.append("--report")
    if verbose:
        cargs.append("--verbose")
    if overwrite:
        cargs.append("--overwrite")
    if single_proc:
        cargs.append("--single_proc")
    if conj_fid:
        cargs.append("--conj_fid")
    if no_conj_fid:
        cargs.append("--no_conj_fid")
    if conj_basis:
        cargs.append("--conj_basis")
    if no_conj_basis:
        cargs.append("--no_conj_basis")
    if no_rescale:
        cargs.append("--no_rescale")
    if config is not None:
        cargs.extend([
            "--config",
            execution.input_file(config)
        ])
    ret = FslMrsiOutputs(
        root=execution.output_file("."),
    )
    execution.run(cargs)
    return ret


__all__ = [
    "FSL_MRSI_METADATA",
    "FslMrsiOutputs",
    "fsl_mrsi",
]
